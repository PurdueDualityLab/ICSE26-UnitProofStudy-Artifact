
<html>
<head>
<title>cbmc/proofs/net/snmp/snmp_ber/encode_string_len/esl_harness.c</title>
<link rel="stylesheet" type="text/css" href="../../../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /**</div><div id="2" class="line none">    2  * @file esl_harness.c</div><div id="3" class="line none">    3  * @author Owen Cochell (owencochell@gmail.com)</div><div id="4" class="line none">    4  * @brief Tests for string len encoding</div><div id="5" class="line none">    5  * @version 0.1</div><div id="6" class="line none">    6  * @date 2024-06-08</div><div id="7" class="line none">    7  * </div><div id="8" class="line none">    8  * @copyright Copyright (c) 2024</div><div id="9" class="line none">    9  * </div><div id="10" class="line none">   10  */</div><div id="11" class="line none">   11 </div><div id="12" class="line none">   12 #include "contiki.h"</div><div id="13" class="line none">   13 #include "net/app-layer/snmp/snmp.h"</div><div id="14" class="line none">   14 #include "net/app-layer/snmp/snmp-ber.h"</div><div id="15" class="line none">   15 </div><div id="16" class="line none">   16 #include "snmp-generic.h"</div><div id="17" class="line none">   17 </div><div id="18" class="line none">   18 void <a href="esl_harness.c.html#18">harness</a>() {</div><div id="19" class="line none">   19 </div><div id="20" class="line none">   20     // First, create packet to be processed:</div><div id="21" class="line hit">   21     <a href="../../../../../../os/net/app-layer/snmp/snmp.h.html#227">snmp_packet_t</a> pack;</div><div id="22" class="line none">   22 </div><div id="23" class="line none">   23     // Initialize:</div><div id="24" class="line none">   24 </div><div id="25" class="line hit">   25     <a href="../../snmp-generic.h.html#70">init_packet_out</a>(&amp;pack);</div><div id="26" class="line none">   26 </div><div id="27" class="line none">   27     // Define length, limit by max size:</div><div id="28" class="line none">   28 </div><div id="29" class="line hit">   29     uint32_t <a href="../../../../../../os/net/app-layer/snmp/snmp.h.html#113">length</a>;</div><div id="30" class="line none">   30 </div><div id="31" class="line hit">   31     __CPROVER_assume(<a href="../../../../../../os/net/app-layer/snmp/snmp.h.html#113">length</a> &lt; 100);</div><div id="32" class="line none">   32 </div><div id="33" class="line none">   33     // Allocate string (won't be null):</div><div id="34" class="line none">   34 </div><div id="35" class="line hit">   35     char* str = (char*)malloc(sizeof(char) * <a href="../../../../../../os/net/app-layer/snmp/snmp.h.html#113">length</a>);</div><div id="36" class="line none">   36 </div><div id="37" class="line hit">   37     __CPROVER_assume(str != NULL);</div><div id="38" class="line none">   38 </div><div id="39" class="line none">   39     // Pass to function:</div><div id="40" class="line none">   40 </div><div id="41" class="line hit">   41     <a href="../../../../../../os/net/app-layer/snmp/snmp-ber.c.html#158">snmp_ber_encode_string_len</a>(&amp;pack, str, <a href="../../../../../../os/net/app-layer/snmp/snmp.h.html#113">length</a>);</div><div id="42" class="line hit">   42 }</div>
</div>
</body>
</html>
