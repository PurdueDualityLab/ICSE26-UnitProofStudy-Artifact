
<html>
<head>
<title>os/net/nbr-table.h</title>
<link rel="stylesheet" type="text/css" href="../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * Copyright (c) 2013, Swedish Institute of Computer Science</div><div id="3" class="line none">    3  * Copyright (c) 2010, Vrije Universiteit Brussel</div><div id="4" class="line none">    4  * All rights reserved.</div><div id="5" class="line none">    5  *</div><div id="6" class="line none">    6  * Redistribution and use in source and binary forms, with or without</div><div id="7" class="line none">    7  * modification, are permitted provided that the following conditions</div><div id="8" class="line none">    8  * are met:</div><div id="9" class="line none">    9  * 1. Redistributions of source code must retain the above copyright</div><div id="10" class="line none">   10  *    notice, this list of conditions and the following disclaimer.</div><div id="11" class="line none">   11  * 2. Redistributions in binary form must reproduce the above copyright</div><div id="12" class="line none">   12  *    notice, this list of conditions and the following disclaimer in the</div><div id="13" class="line none">   13  *    documentation and/or other materials provided with the distribution.</div><div id="14" class="line none">   14  * 3. Neither the name of the Institute nor the names of its contributors</div><div id="15" class="line none">   15  *    may be used to endorse or promote products derived from this software</div><div id="16" class="line none">   16  *    without specific prior written permission.</div><div id="17" class="line none">   17  *</div><div id="18" class="line none">   18  * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND</div><div id="19" class="line none">   19  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</div><div id="20" class="line none">   20  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</div><div id="21" class="line none">   21  * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE</div><div id="22" class="line none">   22  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</div><div id="23" class="line none">   23  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</div><div id="24" class="line none">   24  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</div><div id="25" class="line none">   25  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</div><div id="26" class="line none">   26  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</div><div id="27" class="line none">   27  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</div><div id="28" class="line none">   28  * SUCH DAMAGE.</div><div id="29" class="line none">   29  *</div><div id="30" class="line none">   30  *</div><div id="31" class="line none">   31  * Authors: Simon Duquennoy &lt;simonduq@sics.se&gt;</div><div id="32" class="line none">   32  *          Joris Borms &lt;joris.borms@vub.ac.be&gt;</div><div id="33" class="line none">   33  */</div><div id="34" class="line none">   34 </div><div id="35" class="line none">   35 #ifndef <a href="nbr-table.h.html#36">NBR_TABLE_H_</a></div><div id="36" class="line none">   36 #define <a href="nbr-table.h.html#36">NBR_TABLE_H_</a></div><div id="37" class="line none">   37 </div><div id="38" class="line none">   38 #include "contiki.h"</div><div id="39" class="line none">   39 #include "net/linkaddr.h"</div><div id="40" class="line none">   40 #include "net/netstack.h"</div><div id="41" class="line none">   41 </div><div id="42" class="line none">   42 typedef enum {</div><div id="43" class="line none">   43   <a href="nbr-table.h.html#43">NBR_TABLE_REASON_UNDEFINED</a>,</div><div id="44" class="line none">   44   <a href="nbr-table.h.html#44">NBR_TABLE_REASON_RPL_DIO</a>,</div><div id="45" class="line none">   45   <a href="nbr-table.h.html#45">NBR_TABLE_REASON_RPL_DAO</a>,</div><div id="46" class="line none">   46   <a href="nbr-table.h.html#46">NBR_TABLE_REASON_RPL_DIS</a>,</div><div id="47" class="line none">   47   <a href="nbr-table.h.html#47">NBR_TABLE_REASON_ROUTE</a>,</div><div id="48" class="line none">   48   <a href="nbr-table.h.html#48">NBR_TABLE_REASON_IPV6_ND</a>,</div><div id="49" class="line none">   49   <a href="nbr-table.h.html#49">NBR_TABLE_REASON_MAC</a>,</div><div id="50" class="line none">   50   <a href="nbr-table.h.html#50">NBR_TABLE_REASON_LLSEC</a>,</div><div id="51" class="line none">   51   <a href="nbr-table.h.html#51">NBR_TABLE_REASON_LINK_STATS</a>,</div><div id="52" class="line none">   52   <a href="nbr-table.h.html#52">NBR_TABLE_REASON_IPV6_ND_AUTOFILL</a>,</div><div id="53" class="line none">   53   <a href="nbr-table.h.html#53">NBR_TABLE_REASON_SIXTOP</a>,</div><div id="54" class="line none">   54 } <a href="nbr-table.h.html#54">nbr_table_reason_t</a>;</div><div id="55" class="line none">   55 </div><div id="56" class="line none">   56 #define <a href="nbr-table.h.html#56">NBR_TABLE_MAX_NEIGHBORS</a> NBR_TABLE_CONF_MAX_NEIGHBORS</div><div id="57" class="line none">   57 </div><div id="58" class="line none">   58 #ifdef NBR_TABLE_CONF_GC_GET_WORST</div><div id="59" class="line none">   59 #define <a href="nbr-table.h.html#59">NBR_TABLE_GC_GET_WORST</a> NBR_TABLE_CONF_GC_GET_WORST</div><div id="60" class="line none">   60 #else /* NBR_TABLE_CONF_GC_GET_WORST */</div><div id="61" class="line none">   61 #define <a href="nbr-table.h.html#59">NBR_TABLE_GC_GET_WORST</a> nbr_table_gc_get_worst</div><div id="62" class="line none">   62 #endif /* NBR_TABLE_CONF_GC_GET_WORST */</div><div id="63" class="line none">   63 </div><div id="64" class="line none">   64 #ifdef NBR_TABLE_CONF_CAN_ACCEPT_NEW</div><div id="65" class="line none">   65 #define <a href="nbr-table.h.html#65">NBR_TABLE_CAN_ACCEPT_NEW</a> NBR_TABLE_CONF_CAN_ACCEPT_NEW</div><div id="66" class="line none">   66 #else /* NBR_TABLE_CONF_CAN_ACCEPT_NEW */</div><div id="67" class="line none">   67 #define <a href="nbr-table.h.html#65">NBR_TABLE_CAN_ACCEPT_NEW</a> nbr_table_can_accept_new</div><div id="68" class="line none">   68 #endif /* NBR_TABLE_CONF_CAN_ACCEPT_NEW */</div><div id="69" class="line none">   69 </div><div id="70" class="line none">   70 const <a href="linkaddr.h.html#71">linkaddr_t</a> *<a href="nbr-table.h.html#59">NBR_TABLE_GC_GET_WORST</a>(const <a href="linkaddr.h.html#71">linkaddr_t</a> *lladdr1,</div><div id="71" class="line none">   71                                          const <a href="linkaddr.h.html#71">linkaddr_t</a> *lladdr2);</div><div id="72" class="line none">   72 bool <a href="nbr-table.h.html#65">NBR_TABLE_CAN_ACCEPT_NEW</a>(const <a href="linkaddr.h.html#71">linkaddr_t</a> *new,</div><div id="73" class="line none">   73                               const <a href="linkaddr.h.html#71">linkaddr_t</a> *candidate_for_removal,</div><div id="74" class="line none">   74                               <a href="nbr-table.h.html#54">nbr_table_reason_t</a> reason, const void *<a href="nbr-table.h.html#87">data</a>);</div><div id="75" class="line none">   75 </div><div id="76" class="line none">   76 /* An item in a neighbor table */</div><div id="77" class="line none">   77 typedef void <a href="nbr-table.h.html#77">nbr_table_item_t</a>;</div><div id="78" class="line none">   78 </div><div id="79" class="line none">   79 /* Callback function, called when removing an item from a table */</div><div id="80" class="line none">   80 typedef void(<a href="nbr-table.h.html#80">nbr_table_callback</a>)(<a href="nbr-table.h.html#77">nbr_table_item_t</a> *item);</div><div id="81" class="line none">   81 </div><div id="82" class="line none">   82 /* A neighbor table */</div><div id="83" class="line none">   83 typedef struct <a href="nbr-table.h.html#83">nbr_table</a> {</div><div id="84" class="line none">   84   int <a href="nbr-table.h.html#84">index</a>;</div><div id="85" class="line none">   85   int <a href="nbr-table.h.html#85">item_size</a>;</div><div id="86" class="line none">   86   <a href="nbr-table.h.html#80">nbr_table_callback</a> *<a href="ipv6/uip-ds6-route.h.html#97">callback</a>;</div><div id="87" class="line none">   87   <a href="nbr-table.h.html#77">nbr_table_item_t</a> *<a href="nbr-table.h.html#87">data</a>;</div><div id="88" class="line none">   88 } <a href="nbr-table.h.html#88">nbr_table_t</a>;</div><div id="89" class="line none">   89 </div><div id="90" class="line none">   90 /* List of link-layer addresses of the neighbors, used as key in the tables */</div><div id="91" class="line none">   91 typedef struct <a href="nbr-table.h.html#91">nbr_table_key</a> {</div><div id="92" class="line none">   92   struct <a href="nbr-table.h.html#91">nbr_table_key</a> *<a href="../lib/list.h.html#297">next</a>;</div><div id="93" class="line none">   93   <a href="linkaddr.h.html#71">linkaddr_t</a> <a href="nbr-table.h.html#93">lladdr</a>;</div><div id="94" class="line none">   94 } <a href="nbr-table.h.html#94">nbr_table_key_t</a>;</div><div id="95" class="line none">   95 </div><div id="96" class="line none">   96 /** \brief A static neighbor table. To be initialized through nbr_table_register(name) */</div><div id="97" class="line none">   97 #define <a href="nbr-table.h.html#97">NBR_TABLE</a>(<a href="ipv6/uip-ds6.h.html#209">type</a>, <a href="../sys/log.h.html#104">name</a>) \</div><div id="98" class="line none">   98   static <a href="ipv6/uip-ds6.h.html#209">type</a> _##<a href="../sys/log.h.html#104">name</a>##_mem[<a href="nbr-table.h.html#56">NBR_TABLE_MAX_NEIGHBORS</a>]; \</div><div id="99" class="line none">   99   static <a href="nbr-table.h.html#88">nbr_table_t</a> <a href="../sys/log.h.html#104">name</a>##_struct = { 0, sizeof(<a href="ipv6/uip-ds6.h.html#209">type</a>), NULL, (<a href="nbr-table.h.html#77">nbr_table_item_t</a> *)_##<a href="../sys/log.h.html#104">name</a>##_mem }; \</div><div id="100" class="line none">  100   static <a href="nbr-table.h.html#88">nbr_table_t</a> *<a href="../sys/log.h.html#104">name</a> = &amp;<a href="../sys/log.h.html#104">name</a>##_struct \</div><div id="101" class="line none">  101 </div><div id="102" class="line none">  102 /** \brief A non-static neighbor table. To be initialized through nbr_table_register(name) */</div><div id="103" class="line none">  103 #define <a href="nbr-table.h.html#103">NBR_TABLE_GLOBAL</a>(<a href="ipv6/uip-ds6.h.html#209">type</a>, <a href="../sys/log.h.html#104">name</a>) \</div><div id="104" class="line none">  104   static <a href="ipv6/uip-ds6.h.html#209">type</a> _##<a href="../sys/log.h.html#104">name</a>##_mem[<a href="nbr-table.h.html#56">NBR_TABLE_MAX_NEIGHBORS</a>]; \</div><div id="105" class="line none">  105   static <a href="nbr-table.h.html#88">nbr_table_t</a> <a href="../sys/log.h.html#104">name</a>##_struct = { 0, sizeof(<a href="ipv6/uip-ds6.h.html#209">type</a>), NULL, (<a href="nbr-table.h.html#77">nbr_table_item_t</a> *)_##<a href="../sys/log.h.html#104">name</a>##_mem }; \</div><div id="106" class="line none">  106   <a href="nbr-table.h.html#88">nbr_table_t</a> *<a href="../sys/log.h.html#104">name</a> = &amp;<a href="../sys/log.h.html#104">name</a>##_struct \</div><div id="107" class="line none">  107 </div><div id="108" class="line none">  108 /** \brief Declaration of non-static neighbor tables */</div><div id="109" class="line none">  109 #define <a href="nbr-table.h.html#109">NBR_TABLE_DECLARE</a>(<a href="../sys/log.h.html#104">name</a>) extern <a href="nbr-table.h.html#88">nbr_table_t</a> *<a href="../sys/log.h.html#104">name</a></div><div id="110" class="line none">  110 </div><div id="111" class="line none">  111 /** \name Neighbor tables: register and loop through table elements */</div><div id="112" class="line none">  112 /** @{ */</div><div id="113" class="line none">  113 int nbr_table_register(<a href="nbr-table.h.html#88">nbr_table_t</a> *table, <a href="nbr-table.h.html#80">nbr_table_callback</a> *<a href="ipv6/uip-ds6-route.h.html#97">callback</a>);</div><div id="114" class="line none">  114 int nbr_table_is_registered(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table);</div><div id="115" class="line none">  115 <a href="nbr-table.h.html#77">nbr_table_item_t</a> *nbr_table_head(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table);</div><div id="116" class="line none">  116 <a href="nbr-table.h.html#77">nbr_table_item_t</a> *nbr_table_next(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table,</div><div id="117" class="line none">  117                                  <a href="nbr-table.h.html#77">nbr_table_item_t</a> *item);</div><div id="118" class="line none">  118 /** @} */</div><div id="119" class="line none">  119 </div><div id="120" class="line none">  120 /** \name Neighbor tables: add and get data */</div><div id="121" class="line none">  121 /** @{ */</div><div id="122" class="line none">  122 <a href="nbr-table.h.html#77">nbr_table_item_t</a> *nbr_table_add_lladdr(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table,</div><div id="123" class="line none">  123                                        const <a href="linkaddr.h.html#71">linkaddr_t</a> *<a href="nbr-table.h.html#93">lladdr</a>,</div><div id="124" class="line none">  124                                        <a href="nbr-table.h.html#54">nbr_table_reason_t</a> reason,</div><div id="125" class="line none">  125                                        const void *<a href="nbr-table.h.html#87">data</a>);</div><div id="126" class="line none">  126 <a href="nbr-table.h.html#77">nbr_table_item_t</a> *nbr_table_get_from_lladdr(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table,</div><div id="127" class="line none">  127                                             const <a href="linkaddr.h.html#71">linkaddr_t</a> *<a href="nbr-table.h.html#93">lladdr</a>);</div><div id="128" class="line none">  128 /** @} */</div><div id="129" class="line none">  129 </div><div id="130" class="line none">  130 /** \name Neighbor tables: set flags (unused, locked, unlocked) */</div><div id="131" class="line none">  131 /** @{ */</div><div id="132" class="line none">  132 int nbr_table_remove(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table, const <a href="nbr-table.h.html#77">nbr_table_item_t</a> *item);</div><div id="133" class="line none">  133 int nbr_table_lock(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table, const <a href="nbr-table.h.html#77">nbr_table_item_t</a> *item);</div><div id="134" class="line none">  134 int nbr_table_unlock(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table, const <a href="nbr-table.h.html#77">nbr_table_item_t</a> *item);</div><div id="135" class="line none">  135 /** @} */</div><div id="136" class="line none">  136 </div><div id="137" class="line none">  137 /** \name Neighbor tables: address manipulation */</div><div id="138" class="line none">  138 /** @{ */</div><div id="139" class="line none">  139 <a href="linkaddr.h.html#71">linkaddr_t</a> *nbr_table_get_lladdr(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table,</div><div id="140" class="line none">  140                                  const <a href="nbr-table.h.html#77">nbr_table_item_t</a> *item);</div><div id="141" class="line none">  141 /** @} */</div><div id="142" class="line none">  142 </div><div id="143" class="line none">  143 /** \name Neighbor tables: other */</div><div id="144" class="line none">  144 /** @{ */</div><div id="145" class="line none">  145 void nbr_table_clear(void);</div><div id="146" class="line none">  146 bool nbr_table_entry_is_allowed(const <a href="nbr-table.h.html#88">nbr_table_t</a> *table,</div><div id="147" class="line none">  147                                 const <a href="linkaddr.h.html#71">linkaddr_t</a> *<a href="nbr-table.h.html#93">lladdr</a>,</div><div id="148" class="line none">  148                                 <a href="nbr-table.h.html#54">nbr_table_reason_t</a> reason, const void *<a href="nbr-table.h.html#87">data</a>);</div><div id="149" class="line none">  149 <a href="nbr-table.h.html#94">nbr_table_key_t</a> *nbr_table_key_head(void);</div><div id="150" class="line none">  150 <a href="nbr-table.h.html#94">nbr_table_key_t</a> *nbr_table_key_next(const <a href="nbr-table.h.html#94">nbr_table_key_t</a> *key);</div><div id="151" class="line none">  151 int nbr_table_count_entries(void);</div><div id="152" class="line none">  152 </div><div id="153" class="line none">  153 /** @} */</div><div id="154" class="line none">  154 #endif /* NBR_TABLE_H_ */</div>
</div>
</body>
</html>
