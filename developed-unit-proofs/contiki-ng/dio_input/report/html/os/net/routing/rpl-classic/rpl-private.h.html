
<html>
<head>
<title>os/net/routing/rpl-classic/rpl-private.h</title>
<link rel="stylesheet" type="text/css" href="../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * Copyright (c) 2010, Swedish Institute of Computer Science.</div><div id="3" class="line none">    3  * All rights reserved.</div><div id="4" class="line none">    4  *</div><div id="5" class="line none">    5  * Redistribution and use in source and binary forms, with or without</div><div id="6" class="line none">    6  * modification, are permitted provided that the following conditions</div><div id="7" class="line none">    7  * are met:</div><div id="8" class="line none">    8  * 1. Redistributions of source code must retain the above copyright</div><div id="9" class="line none">    9  *    notice, this list of conditions and the following disclaimer.</div><div id="10" class="line none">   10  * 2. Redistributions in binary form must reproduce the above copyright</div><div id="11" class="line none">   11  *    notice, this list of conditions and the following disclaimer in the</div><div id="12" class="line none">   12  *    documentation and/or other materials provided with the distribution.</div><div id="13" class="line none">   13  * 3. Neither the name of the Institute nor the names of its contributors</div><div id="14" class="line none">   14  *    may be used to endorse or promote products derived from this software</div><div id="15" class="line none">   15  *    without specific prior written permission.</div><div id="16" class="line none">   16  *</div><div id="17" class="line none">   17  * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND</div><div id="18" class="line none">   18  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</div><div id="19" class="line none">   19  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</div><div id="20" class="line none">   20  * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE</div><div id="21" class="line none">   21  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</div><div id="22" class="line none">   22  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</div><div id="23" class="line none">   23  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</div><div id="24" class="line none">   24  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</div><div id="25" class="line none">   25  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</div><div id="26" class="line none">   26  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</div><div id="27" class="line none">   27  * SUCH DAMAGE.</div><div id="28" class="line none">   28  */</div><div id="29" class="line none">   29 </div><div id="30" class="line none">   30 /*</div><div id="31" class="line none">   31  * \file</div><div id="32" class="line none">   32  *   Private declarations for ContikiRPL.</div><div id="33" class="line none">   33  * \author</div><div id="34" class="line none">   34  *   Joakim Eriksson &lt;joakime@sics.se&gt;, Nicolas Tsiftes &lt;nvt@sics.se&gt;</div><div id="35" class="line none">   35  */</div><div id="36" class="line none">   36 </div><div id="37" class="line none">   37 #ifndef <a href="rpl-private.h.html#38">RPL_PRIVATE_H</a></div><div id="38" class="line none">   38 #define <a href="rpl-private.h.html#38">RPL_PRIVATE_H</a></div><div id="39" class="line none">   39 </div><div id="40" class="line none">   40 #include "net/routing/rpl-classic/rpl.h"</div><div id="41" class="line none">   41 </div><div id="42" class="line none">   42 #include "lib/list.h"</div><div id="43" class="line none">   43 #include "net/ipv6/uip.h"</div><div id="44" class="line none">   44 #include "sys/clock.h"</div><div id="45" class="line none">   45 #include "sys/ctimer.h"</div><div id="46" class="line none">   46 #include "net/ipv6/uip-ds6.h"</div><div id="47" class="line none">   47 #include "net/ipv6/uip-ds6-route.h"</div><div id="48" class="line none">   48 #include "net/ipv6/multicast/uip-mcast6.h"</div><div id="49" class="line none">   49 </div><div id="50" class="line none">   50 /*---------------------------------------------------------------------------*/</div><div id="51" class="line none">   51 /** \brief Is IPv6 address addr the link-local, all-RPL-nodes</div><div id="52" class="line none">   52     multicast address? */</div><div id="53" class="line none">   53 #define <a href="rpl-private.h.html#53">uip_is_addr_linklocal_rplnodes_mcast</a>(<a href="../../ipv6/uip.h.html#113">addr</a>)          \</div><div id="54" class="line none">   54   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#96">u8</a>[0] == 0xff) &amp;&amp;                                \</div><div id="55" class="line none">   55   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#96">u8</a>[1] == 0x02) &amp;&amp;                                \</div><div id="56" class="line none">   56   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#97">u16</a>[1] == 0) &amp;&amp;                                  \</div><div id="57" class="line none">   57   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#97">u16</a>[2] == 0) &amp;&amp;                                  \</div><div id="58" class="line none">   58   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#97">u16</a>[3] == 0) &amp;&amp;                                  \</div><div id="59" class="line none">   59   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#97">u16</a>[4] == 0) &amp;&amp;                                  \</div><div id="60" class="line none">   60   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#97">u16</a>[5] == 0) &amp;&amp;                                  \</div><div id="61" class="line none">   61   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#97">u16</a>[6] == 0) &amp;&amp;                                  \</div><div id="62" class="line none">   62   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#96">u8</a>[14] == 0) &amp;&amp;                                  \</div><div id="63" class="line none">   63   ((<a href="../../ipv6/uip.h.html#113">addr</a>)-&gt;<a href="../../ipv6/uip.h.html#96">u8</a>[15] == 0x1a))</div><div id="64" class="line none">   64 </div><div id="65" class="line none">   65 /** \brief Set IP address addr to the link-local, all-rpl-nodes</div><div id="66" class="line none">   66     multicast address. */</div><div id="67" class="line none">   67 #define <a href="rpl-private.h.html#67">uip_create_linklocal_rplnodes_mcast</a>(<a href="../../ipv6/uip.h.html#113">addr</a>)       \</div><div id="68" class="line none">   68   <a href="../../ipv6/uip.h.html#912">uip_ip6addr</a>((<a href="../../ipv6/uip.h.html#113">addr</a>), 0xff02, 0, 0, 0, 0, 0, 0, 0x001a)</div><div id="69" class="line none">   69 /*---------------------------------------------------------------------------*/</div><div id="70" class="line none">   70 /* RPL message types */</div><div id="71" class="line none">   71 #define <a href="rpl-private.h.html#71">RPL_CODE_DIS</a>                   0x00   /* DAG Information Solicitation */</div><div id="72" class="line none">   72 #define <a href="rpl-private.h.html#72">RPL_CODE_DIO</a>                   0x01   /* DAG Information Option */</div><div id="73" class="line none">   73 #define <a href="rpl-private.h.html#73">RPL_CODE_DAO</a>                   0x02   /* Destination Advertisement Option */</div><div id="74" class="line none">   74 #define <a href="rpl-private.h.html#74">RPL_CODE_DAO_ACK</a>               0x03   /* DAO acknowledgment */</div><div id="75" class="line none">   75 #define <a href="rpl-private.h.html#75">RPL_CODE_SEC_DIS</a>               0x80   /* Secure DIS */</div><div id="76" class="line none">   76 #define <a href="rpl-private.h.html#76">RPL_CODE_SEC_DIO</a>               0x81   /* Secure DIO */</div><div id="77" class="line none">   77 #define <a href="rpl-private.h.html#77">RPL_CODE_SEC_DAO</a>               0x82   /* Secure DAO */</div><div id="78" class="line none">   78 #define <a href="rpl-private.h.html#78">RPL_CODE_SEC_DAO_ACK</a>           0x83   /* Secure DAO ACK */</div><div id="79" class="line none">   79 </div><div id="80" class="line none">   80 /* RPL control message options. */</div><div id="81" class="line none">   81 #define <a href="rpl-private.h.html#81">RPL_OPTION_PAD1</a>                  0</div><div id="82" class="line none">   82 #define <a href="rpl-private.h.html#82">RPL_OPTION_PADN</a>                  1</div><div id="83" class="line none">   83 #define <a href="rpl-private.h.html#83">RPL_OPTION_DAG_METRIC_CONTAINER</a>  2</div><div id="84" class="line none">   84 #define <a href="rpl-private.h.html#84">RPL_OPTION_ROUTE_INFO</a>            3</div><div id="85" class="line none">   85 #define <a href="rpl-private.h.html#85">RPL_OPTION_DAG_CONF</a>              4</div><div id="86" class="line none">   86 #define <a href="rpl-private.h.html#86">RPL_OPTION_TARGET</a>                5</div><div id="87" class="line none">   87 #define <a href="rpl-private.h.html#87">RPL_OPTION_TRANSIT</a>               6</div><div id="88" class="line none">   88 #define <a href="rpl-private.h.html#88">RPL_OPTION_SOLICITED_INFO</a>        7</div><div id="89" class="line none">   89 #define <a href="rpl-private.h.html#89">RPL_OPTION_PREFIX_INFO</a>           8</div><div id="90" class="line none">   90 #define <a href="rpl-private.h.html#90">RPL_OPTION_TARGET_DESC</a>           9</div><div id="91" class="line none">   91 </div><div id="92" class="line none">   92 #define <a href="rpl-private.h.html#92">RPL_DAO_K_FLAG</a>                   0x80 /* DAO ACK requested */</div><div id="93" class="line none">   93 #define <a href="rpl-private.h.html#93">RPL_DAO_D_FLAG</a>                   0x40 /* DODAG ID present */</div><div id="94" class="line none">   94 </div><div id="95" class="line none">   95 #define <a href="rpl-private.h.html#95">RPL_DAO_ACK_UNCONDITIONAL_ACCEPT</a> 0</div><div id="96" class="line none">   96 #define <a href="rpl-private.h.html#96">RPL_DAO_ACK_ACCEPT</a>               1   /* 1 - 127 is OK but not good */</div><div id="97" class="line none">   97 #define <a href="rpl-private.h.html#97">RPL_DAO_ACK_UNABLE_TO_ACCEPT</a>     128 /* &gt;127 is fail */</div><div id="98" class="line none">   98 #define <a href="rpl-private.h.html#98">RPL_DAO_ACK_UNABLE_TO_ADD_ROUTE_AT_ROOT</a> 255 /* root can not accept */</div><div id="99" class="line none">   99 </div><div id="100" class="line none">  100 #define <a href="rpl-private.h.html#100">RPL_DAO_ACK_TIMEOUT</a>              -1</div><div id="101" class="line none">  101 </div><div id="102" class="line none">  102 /*---------------------------------------------------------------------------*/</div><div id="103" class="line none">  103 /* RPL IPv6 extension header option. */</div><div id="104" class="line none">  104 #define <a href="rpl-private.h.html#104">RPL_HDR_OPT_LEN</a>                 4</div><div id="105" class="line none">  105 #define <a href="rpl-private.h.html#105">RPL_HOP_BY_HOP_LEN</a>              (<a href="rpl-private.h.html#104">RPL_HDR_OPT_LEN</a> + 2 + 2)</div><div id="106" class="line none">  106 #define <a href="rpl-private.h.html#106">RPL_RH_LEN</a>     4</div><div id="107" class="line none">  107 #define <a href="rpl-private.h.html#107">RPL_SRH_LEN</a>    4</div><div id="108" class="line none">  108 #define <a href="rpl-private.h.html#108">RPL_RH_TYPE_SRH</a>   3</div><div id="109" class="line none">  109 #define <a href="rpl-private.h.html#109">RPL_HDR_OPT_DOWN</a>                0x80</div><div id="110" class="line none">  110 #define <a href="rpl-private.h.html#110">RPL_HDR_OPT_DOWN_SHIFT</a>          7</div><div id="111" class="line none">  111 #define <a href="rpl-private.h.html#111">RPL_HDR_OPT_RANK_ERR</a>            0x40</div><div id="112" class="line none">  112 #define <a href="rpl-private.h.html#112">RPL_HDR_OPT_RANK_ERR_SHIFT</a>      6</div><div id="113" class="line none">  113 #define <a href="rpl-private.h.html#113">RPL_HDR_OPT_FWD_ERR</a>             0x20</div><div id="114" class="line none">  114 #define <a href="rpl-private.h.html#114">RPL_HDR_OPT_FWD_ERR_SHIFT</a>       5</div><div id="115" class="line none">  115 /*---------------------------------------------------------------------------*/</div><div id="116" class="line none">  116 /* Default values for RPL constants and variables. */</div><div id="117" class="line none">  117 </div><div id="118" class="line none">  118 /* DAO transmissions are always delayed by RPL_DAO_DELAY +/- RPL_DAO_DELAY/2 */</div><div id="119" class="line none">  119 #ifdef RPL_CONF_DAO_DELAY</div><div id="120" class="line none">  120 #define <a href="rpl-private.h.html#120">RPL_DAO_DELAY</a>                 RPL_CONF_DAO_DELAY</div><div id="121" class="line none">  121 #else /* RPL_CONF_DAO_DELAY */</div><div id="122" class="line none">  122 #define <a href="rpl-private.h.html#120">RPL_DAO_DELAY</a>                 (<a href="../../../sys/clock.h.html#101">CLOCK_SECOND</a> * 4)</div><div id="123" class="line none">  123 #endif /* RPL_CONF_DAO_DELAY */</div><div id="124" class="line none">  124 </div><div id="125" class="line none">  125 /* Delay between reception of a no-path DAO and actual route removal */</div><div id="126" class="line none">  126 #ifdef RPL_CONF_NOPATH_REMOVAL_DELAY</div><div id="127" class="line none">  127 #define <a href="rpl-private.h.html#127">RPL_NOPATH_REMOVAL_DELAY</a>          RPL_CONF_NOPATH_REMOVAL_DELAY</div><div id="128" class="line none">  128 #else /* RPL_CONF_NOPATH_REMOVAL_DELAY */</div><div id="129" class="line none">  129 #define <a href="rpl-private.h.html#127">RPL_NOPATH_REMOVAL_DELAY</a>          60</div><div id="130" class="line none">  130 #endif /* RPL_CONF_NOPATH_REMOVAL_DELAY */</div><div id="131" class="line none">  131 </div><div id="132" class="line none">  132 #ifdef RPL_CONF_DAO_MAX_RETRANSMISSIONS</div><div id="133" class="line none">  133 #define <a href="rpl-private.h.html#133">RPL_DAO_MAX_RETRANSMISSIONS</a> RPL_CONF_DAO_MAX_RETRANSMISSIONS</div><div id="134" class="line none">  134 #else</div><div id="135" class="line none">  135 #define <a href="rpl-private.h.html#133">RPL_DAO_MAX_RETRANSMISSIONS</a>     5</div><div id="136" class="line none">  136 #endif /* RPL_CONF_DAO_MAX_RETRANSMISSIONS */</div><div id="137" class="line none">  137 </div><div id="138" class="line none">  138 #ifdef RPL_CONF_DAO_RETRANSMISSION_TIMEOUT</div><div id="139" class="line none">  139 #define <a href="rpl-private.h.html#139">RPL_DAO_RETRANSMISSION_TIMEOUT</a> RPL_CONF_DAO_RETRANSMISSION_TIMEOUT</div><div id="140" class="line none">  140 #else</div><div id="141" class="line none">  141 #define <a href="rpl-private.h.html#139">RPL_DAO_RETRANSMISSION_TIMEOUT</a>  (5 * <a href="../../../sys/clock.h.html#101">CLOCK_SECOND</a>)</div><div id="142" class="line none">  142 #endif /* RPL_CONF_DAO_RETRANSMISSION_TIMEOUT */</div><div id="143" class="line none">  143 </div><div id="144" class="line none">  144 /* Special value indicating immediate removal. */</div><div id="145" class="line none">  145 #define <a href="rpl-private.h.html#145">RPL_ZERO_LIFETIME</a>               0</div><div id="146" class="line none">  146 </div><div id="147" class="line none">  147 /* Special value indicating infinite lifetime. */</div><div id="148" class="line none">  148 #define <a href="rpl-private.h.html#148">RPL_INFINITE_LIFETIME</a>           0xFF</div><div id="149" class="line none">  149 </div><div id="150" class="line none">  150 #define <a href="rpl-private.h.html#150">RPL_ROUTE_INFINITE_LIFETIME</a>           0xFFFFFFFF</div><div id="151" class="line none">  151 </div><div id="152" class="line none">  152 #define <a href="rpl-private.h.html#152">RPL_LIFETIME</a>(<a href="../../ipv6/uip.h.html#1631">instance</a>, <a href="../../ipv6/uip-ds6-route.h.html#156">lifetime</a>) \</div><div id="153" class="line none">  153           (((<a href="../../ipv6/uip-ds6-route.h.html#156">lifetime</a>) == <a href="rpl-private.h.html#148">RPL_INFINITE_LIFETIME</a>) ? \</div><div id="154" class="line none">  154               <a href="rpl-private.h.html#150">RPL_ROUTE_INFINITE_LIFETIME</a> : \</div><div id="155" class="line none">  155               (unsigned long)(<a href="../../ipv6/uip.h.html#1631">instance</a>)-&gt;<a href="rpl-private.h.html#242">lifetime_unit</a> * (<a href="../../ipv6/uip-ds6-route.h.html#156">lifetime</a>))</div><div id="156" class="line none">  156 </div><div id="157" class="line none">  157 </div><div id="158" class="line none">  158 #ifndef RPL_CONF_MIN_HOPRANKINC</div><div id="159" class="line none">  159 /*</div><div id="160" class="line none">  160  * RFC6550 defines the default MIN_HOPRANKINC as 256.  However, we use</div><div id="161" class="line none">  161  * MRHOF as a default Objective Function (RFC6719), which recommends</div><div id="162" class="line none">  162  * setting MIN_HOPRANKINC with care, in particular when used with ETX</div><div id="163" class="line none">  163  * as a metric. ETX is computed as a fixed point real with a divisor</div><div id="164" class="line none">  164  * of 128 (RFC6719, RFC6551). We choose to also use 128 for</div><div id="165" class="line none">  165  * RPL_MIN_HOPRANKINC, resulting in a rank equal to the ETX path</div><div id="166" class="line none">  166  * cost. Larger values may also be desirable, as discussed in section</div><div id="167" class="line none">  167  * 6.1 of RFC6719.</div><div id="168" class="line none">  168  */</div><div id="169" class="line none">  169 #if RPL_OF_OCP == <a href="rpl.h.html#89">RPL_OCP_MRHOF</a></div><div id="170" class="line none">  170 #define <a href="rpl-private.h.html#170">RPL_MIN_HOPRANKINC</a>          128</div><div id="171" class="line none">  171 #else /* RPL_OF_OCP == RPL_OCP_MRHOF */</div><div id="172" class="line none">  172 #define <a href="rpl-private.h.html#170">RPL_MIN_HOPRANKINC</a>          256</div><div id="173" class="line none">  173 #endif /* RPL_OF_OCP == RPL_OCP_MRHOF */</div><div id="174" class="line none">  174 #else /* RPL_CONF_MIN_HOPRANKINC */</div><div id="175" class="line none">  175 #define <a href="rpl-private.h.html#170">RPL_MIN_HOPRANKINC</a>          RPL_CONF_MIN_HOPRANKINC</div><div id="176" class="line none">  176 #endif /* RPL_CONF_MIN_HOPRANKINC */</div><div id="177" class="line none">  177 </div><div id="178" class="line none">  178 #ifndef RPL_CONF_MAX_RANKINC</div><div id="179" class="line none">  179 #define <a href="rpl-private.h.html#179">RPL_MAX_RANKINC</a>             (7 * <a href="rpl-private.h.html#170">RPL_MIN_HOPRANKINC</a>)</div><div id="180" class="line none">  180 #else /* RPL_CONF_MAX_RANKINC */</div><div id="181" class="line none">  181 #define <a href="rpl-private.h.html#179">RPL_MAX_RANKINC</a>             RPL_CONF_MAX_RANKINC</div><div id="182" class="line none">  182 #endif /* RPL_CONF_MAX_RANKINC */</div><div id="183" class="line none">  183 </div><div id="184" class="line none">  184 #define <a href="rpl-private.h.html#184">DAG_RANK</a>(fixpt_rank, <a href="../../ipv6/uip.h.html#1631">instance</a>) \</div><div id="185" class="line none">  185   ((fixpt_rank) / (<a href="../../ipv6/uip.h.html#1631">instance</a>)-&gt;<a href="rpl.h.html#247">min_hoprankinc</a>)</div><div id="186" class="line none">  186 </div><div id="187" class="line none">  187 /* Rank of a virtual root node that coordinates DAG root nodes. */</div><div id="188" class="line none">  188 #define <a href="rpl-private.h.html#188">BASE_RANK</a>                       0</div><div id="189" class="line none">  189 </div><div id="190" class="line none">  190 /* Rank of a root node. */</div><div id="191" class="line none">  191 #define <a href="rpl-private.h.html#191">ROOT_RANK</a>(<a href="../../ipv6/uip.h.html#1631">instance</a>)             (<a href="../../ipv6/uip.h.html#1631">instance</a>)-&gt;<a href="rpl.h.html#247">min_hoprankinc</a></div><div id="192" class="line none">  192 </div><div id="193" class="line none">  193 #define <a href="rpl-private.h.html#193">RPL_INFINITE_RANK</a>                   0xffff</div><div id="194" class="line none">  194 </div><div id="195" class="line none">  195 /*---------------------------------------------------------------------------*/</div><div id="196" class="line none">  196 #define <a href="rpl-private.h.html#196">RPL_INSTANCE_LOCAL_FLAG</a>         0x80</div><div id="197" class="line none">  197 #define <a href="rpl-private.h.html#197">RPL_INSTANCE_D_FLAG</a>             0x40</div><div id="198" class="line none">  198 </div><div id="199" class="line none">  199 /* Values that tell where a route came from. */</div><div id="200" class="line none">  200 #define <a href="rpl-private.h.html#200">RPL_ROUTE_FROM_INTERNAL</a>         0</div><div id="201" class="line none">  201 #define <a href="rpl-private.h.html#201">RPL_ROUTE_FROM_UNICAST_DAO</a>      1</div><div id="202" class="line none">  202 #define <a href="rpl-private.h.html#202">RPL_ROUTE_FROM_MULTICAST_DAO</a>    2</div><div id="203" class="line none">  203 #define <a href="rpl-private.h.html#203">RPL_ROUTE_FROM_DIO</a>              3</div><div id="204" class="line none">  204 </div><div id="205" class="line none">  205 /* DIS related */</div><div id="206" class="line none">  206 #define <a href="rpl-private.h.html#206">RPL_DIS_SEND</a>                    1</div><div id="207" class="line none">  207 </div><div id="208" class="line none">  208 /*---------------------------------------------------------------------------*/</div><div id="209" class="line none">  209 /* Lollipop counters */</div><div id="210" class="line none">  210 #define <a href="rpl-private.h.html#210">RPL_LOLLIPOP_MAX_VALUE</a>           255</div><div id="211" class="line none">  211 #define <a href="rpl-private.h.html#211">RPL_LOLLIPOP_CIRCULAR_REGION</a>     127</div><div id="212" class="line none">  212 #define <a href="rpl-private.h.html#212">RPL_LOLLIPOP_SEQUENCE_WINDOWS</a>    16</div><div id="213" class="line none">  213 #define <a href="rpl-private.h.html#213">RPL_LOLLIPOP_INIT</a>                (<a href="rpl-private.h.html#210">RPL_LOLLIPOP_MAX_VALUE</a> - <a href="rpl-private.h.html#212">RPL_LOLLIPOP_SEQUENCE_WINDOWS</a> + 1)</div><div id="214" class="line none">  214 </div><div id="215" class="line none">  215 #define <a href="rpl-private.h.html#215">RPL_LOLLIPOP_INCREMENT</a>(counter)                                 \</div><div id="216" class="line none">  216   do {                                                                  \</div><div id="217" class="line none">  217     if((counter) &gt; <a href="rpl-private.h.html#211">RPL_LOLLIPOP_CIRCULAR_REGION</a>) {                      \</div><div id="218" class="line none">  218       (counter) = ((counter) + 1) &amp; <a href="rpl-private.h.html#210">RPL_LOLLIPOP_MAX_VALUE</a>;             \</div><div id="219" class="line none">  219     } else {                                                            \</div><div id="220" class="line none">  220       (counter) = ((counter) + 1) &amp; <a href="rpl-private.h.html#211">RPL_LOLLIPOP_CIRCULAR_REGION</a>;       \</div><div id="221" class="line none">  221     }                                                                   \</div><div id="222" class="line none">  222   } while(0)</div><div id="223" class="line none">  223 </div><div id="224" class="line none">  224 #define <a href="rpl-private.h.html#224">RPL_LOLLIPOP_IS_INIT</a>(counter)           \</div><div id="225" class="line none">  225   ((counter) &gt; <a href="rpl-private.h.html#211">RPL_LOLLIPOP_CIRCULAR_REGION</a>)</div><div id="226" class="line none">  226 /*---------------------------------------------------------------------------*/</div><div id="227" class="line none">  227 /* Logical representation of a DAG Information Object (DIO.) */</div><div id="228" class="line none">  228 struct <a href="rpl-private.h.html#228">rpl_dio</a> {</div><div id="229" class="line none">  229   <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> <a href="rpl-private.h.html#229">dag_id</a>;</div><div id="230" class="line none">  230   <a href="rpl.h.html#49">rpl_ocp_t</a> <a href="rpl-private.h.html#230">ocp</a>;</div><div id="231" class="line none">  231   <a href="rpl.h.html#48">rpl_rank_t</a> <a href="rpl-private.h.html#231">rank</a>;</div><div id="232" class="line none">  232   uint8_t <a href="rpl-private.h.html#232">grounded</a>;</div><div id="233" class="line none">  233   uint8_t <a href="rpl-private.h.html#233">mop</a>;</div><div id="234" class="line none">  234   uint8_t <a href="rpl-private.h.html#234">preference</a>;</div><div id="235" class="line none">  235   uint8_t <a href="rpl-private.h.html#235">version</a>;</div><div id="236" class="line none">  236   uint8_t <a href="rpl-private.h.html#236">instance_id</a>;</div><div id="237" class="line none">  237   uint8_t <a href="rpl-private.h.html#237">dtsn</a>;</div><div id="238" class="line none">  238   uint8_t <a href="rpl-private.h.html#238">dag_intdoubl</a>;</div><div id="239" class="line none">  239   uint8_t <a href="rpl-private.h.html#239">dag_intmin</a>;</div><div id="240" class="line none">  240   uint8_t <a href="rpl-private.h.html#240">dag_redund</a>;</div><div id="241" class="line none">  241   uint8_t <a href="rpl-private.h.html#241">default_lifetime</a>;</div><div id="242" class="line none">  242   uint16_t <a href="rpl-private.h.html#242">lifetime_unit</a>;</div><div id="243" class="line none">  243   <a href="rpl.h.html#48">rpl_rank_t</a> <a href="rpl-private.h.html#243">dag_max_rankinc</a>;</div><div id="244" class="line none">  244   <a href="rpl.h.html#48">rpl_rank_t</a> <a href="rpl-private.h.html#244">dag_min_hoprankinc</a>;</div><div id="245" class="line none">  245   <a href="rpl.h.html#134">rpl_prefix_t</a> <a href="rpl-private.h.html#245">destination_prefix</a>;</div><div id="246" class="line none">  246   <a href="rpl.h.html#134">rpl_prefix_t</a> <a href="rpl-private.h.html#246">prefix_info</a>;</div><div id="247" class="line none">  247   struct <a href="rpl.h.html#97">rpl_metric_container</a> <a href="rpl-private.h.html#247">mc</a>;</div><div id="248" class="line none">  248 };</div><div id="249" class="line none">  249 typedef struct <a href="rpl-private.h.html#228">rpl_dio</a> <a href="rpl-private.h.html#249">rpl_dio_t</a>;</div><div id="250" class="line none">  250 </div><div id="251" class="line none">  251 #if RPL_CONF_STATS</div><div id="252" class="line none">  252 /* Statistics for fault management. */</div><div id="253" class="line none">  253 struct <a href="rpl-private.h.html#253">rpl_stats</a> {</div><div id="254" class="line none">  254   uint16_t <a href="rpl-private.h.html#254">mem_overflows</a>;</div><div id="255" class="line none">  255   uint16_t <a href="rpl-private.h.html#255">local_repairs</a>;</div><div id="256" class="line none">  256   uint16_t <a href="rpl-private.h.html#256">global_repairs</a>;</div><div id="257" class="line none">  257   uint16_t <a href="rpl-private.h.html#257">malformed_msgs</a>;</div><div id="258" class="line none">  258   uint16_t <a href="rpl-private.h.html#258">resets</a>;</div><div id="259" class="line none">  259   uint16_t <a href="rpl-private.h.html#259">parent_switch</a>;</div><div id="260" class="line none">  260   uint16_t <a href="rpl-private.h.html#260">forward_errors</a>;</div><div id="261" class="line none">  261   uint16_t <a href="rpl-private.h.html#261">loop_errors</a>;</div><div id="262" class="line none">  262   uint16_t <a href="rpl-private.h.html#262">loop_warnings</a>;</div><div id="263" class="line none">  263   uint16_t <a href="rpl-private.h.html#263">root_repairs</a>;</div><div id="264" class="line none">  264 };</div><div id="265" class="line none">  265 typedef struct <a href="rpl-private.h.html#253">rpl_stats</a> <a href="rpl-private.h.html#265">rpl_stats_t</a>;</div><div id="266" class="line none">  266 </div><div id="267" class="line none">  267 extern <a href="rpl-private.h.html#265">rpl_stats_t</a> <a href="rpl-private.h.html#253">rpl_stats</a>;</div><div id="268" class="line none">  268 #endif</div><div id="269" class="line none">  269 </div><div id="270" class="line none">  270 /* RPL callbacks when TSCH is enabled. */</div><div id="271" class="line none">  271 #if MAC_CONF_WITH_TSCH</div><div id="272" class="line none">  272 </div><div id="273" class="line none">  273 #ifndef <a href="rpl-private.h.html#274">RPL_CALLBACK_PARENT_SWITCH</a></div><div id="274" class="line none">  274 #define <a href="rpl-private.h.html#274">RPL_CALLBACK_PARENT_SWITCH</a> tsch_rpl_callback_parent_switch</div><div id="275" class="line none">  275 #endif /* RPL_CALLBACK_PARENT_SWITCH */</div><div id="276" class="line none">  276 </div><div id="277" class="line none">  277 #ifndef <a href="rpl-private.h.html#278">RPL_CALLBACK_NEW_DIO_INTERVAL</a></div><div id="278" class="line none">  278 #define <a href="rpl-private.h.html#278">RPL_CALLBACK_NEW_DIO_INTERVAL</a> tsch_rpl_callback_new_dio_interval</div><div id="279" class="line none">  279 #endif /* RPL_CALLBACK_NEW_DIO_INTERVAL */</div><div id="280" class="line none">  280 </div><div id="281" class="line none">  281 #endif /* MAC_CONF_WITH_TSCH */</div><div id="282" class="line none">  282 </div><div id="283" class="line none">  283 /*---------------------------------------------------------------------------*/</div><div id="284" class="line none">  284 /* RPL macros. */</div><div id="285" class="line none">  285 </div><div id="286" class="line none">  286 #if RPL_CONF_STATS</div><div id="287" class="line none">  287 #define <a href="rpl-private.h.html#287">RPL_STAT</a>(code)  (code)</div><div id="288" class="line none">  288 #else</div><div id="289" class="line none">  289 #define <a href="rpl-private.h.html#287">RPL_STAT</a>(code)</div><div id="290" class="line none">  290 #endif /* RPL_CONF_STATS */</div><div id="291" class="line none">  291 </div><div id="292" class="line none">  292 /*---------------------------------------------------------------------------*/</div><div id="293" class="line none">  293 /* Instances */</div><div id="294" class="line none">  294 extern <a href="rpl.h.html#154">rpl_instance_t</a> <a href="rpl-private.h.html#294">instance_table</a>[];</div><div id="295" class="line none">  295 extern <a href="rpl.h.html#154">rpl_instance_t</a> *default_instance;</div><div id="296" class="line none">  296 </div><div id="297" class="line none">  297 /* ICMPv6 functions for RPL. */</div><div id="298" class="line none">  298 void <a href="rpl-icmp6.c.html#253">dis_output</a>(<a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *<a href="../../ipv6/uip.h.html#113">addr</a>);</div><div id="299" class="line none">  299 void <a href="rpl-icmp6.c.html#505">dio_output</a>(<a href="rpl.h.html#154">rpl_instance_t</a> *, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *uc_addr);</div><div id="300" class="line none">  300 void <a href="rpl-icmp6.c.html#1221">dao_output</a>(<a href="rpl.h.html#125">rpl_parent_t</a> *, uint8_t <a href="../../ipv6/uip-ds6-route.h.html#156">lifetime</a>);</div><div id="301" class="line none">  301 void <a href="rpl-icmp6.c.html#1265">dao_output_target</a>(<a href="rpl.h.html#125">rpl_parent_t</a> *, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *, uint8_t <a href="../../ipv6/uip-ds6-route.h.html#156">lifetime</a>);</div><div id="302" class="line none">  302 void <a href="rpl-icmp6.c.html#1488">dao_ack_output</a>(<a href="rpl.h.html#154">rpl_instance_t</a> *, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *, uint8_t, uint8_t);</div><div id="303" class="line none">  303 void <a href="rpl-icmp6.c.html#1511">rpl_icmp6_register_handlers</a>(void);</div><div id="304" class="line none">  304 <a href="../../ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a> *<a href="rpl-icmp6.c.html#190">rpl_icmp6_update_nbr_table</a>(<a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *from,</div><div id="305" class="line none">  305                                           <a href="../../nbr-table.h.html#54">nbr_table_reason_t</a> r, void *<a href="../../nbr-table.h.html#87">data</a>);</div><div id="306" class="line none">  306 </div><div id="307" class="line none">  307 /* RPL logic functions. */</div><div id="308" class="line none">  308 void rpl_join_dag(<a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *from, <a href="rpl-private.h.html#249">rpl_dio_t</a> *dio);</div><div id="309" class="line none">  309 void rpl_join_instance(<a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *from, <a href="rpl-private.h.html#249">rpl_dio_t</a> *dio);</div><div id="310" class="line none">  310 void rpl_local_repair(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>);</div><div id="311" class="line none">  311 void <a href="rpl-private.h.html#311">rpl_process_dio</a>(<a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *, <a href="rpl-private.h.html#249">rpl_dio_t</a> *);</div><div id="312" class="line none">  312 int rpl_process_parent_event(<a href="rpl.h.html#154">rpl_instance_t</a> *, <a href="rpl.h.html#125">rpl_parent_t</a> *);</div><div id="313" class="line none">  313 </div><div id="314" class="line none">  314 /* DAG object management. */</div><div id="315" class="line none">  315 <a href="rpl.h.html#153">rpl_dag_t</a> *rpl_alloc_dag(uint8_t, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *);</div><div id="316" class="line none">  316 <a href="rpl.h.html#154">rpl_instance_t</a> *rpl_alloc_instance(uint8_t);</div><div id="317" class="line none">  317 void rpl_free_dag(<a href="rpl.h.html#153">rpl_dag_t</a> *);</div><div id="318" class="line none">  318 void rpl_free_instance(<a href="rpl.h.html#154">rpl_instance_t</a> *);</div><div id="319" class="line none">  319 void rpl_purge_dags(void);</div><div id="320" class="line none">  320 </div><div id="321" class="line none">  321 /* DAG parent management function. */</div><div id="322" class="line none">  322 <a href="rpl.h.html#125">rpl_parent_t</a> *rpl_add_parent(<a href="rpl.h.html#153">rpl_dag_t</a> *, <a href="rpl-private.h.html#249">rpl_dio_t</a> *dio, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *);</div><div id="323" class="line none">  323 <a href="rpl.h.html#125">rpl_parent_t</a> *<a href="rpl-private.h.html#323">rpl_find_parent</a>(<a href="rpl.h.html#153">rpl_dag_t</a> *, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *);</div><div id="324" class="line none">  324 <a href="rpl.h.html#125">rpl_parent_t</a> *rpl_find_parent_any_dag(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *<a href="../../ipv6/uip.h.html#113">addr</a>);</div><div id="325" class="line none">  325 void rpl_nullify_parent(<a href="rpl.h.html#125">rpl_parent_t</a> *);</div><div id="326" class="line none">  326 void rpl_remove_parent(<a href="rpl.h.html#125">rpl_parent_t</a> *);</div><div id="327" class="line none">  327 void rpl_move_parent(<a href="rpl.h.html#153">rpl_dag_t</a> *dag_src, <a href="rpl.h.html#153">rpl_dag_t</a> *dag_dst, <a href="rpl.h.html#125">rpl_parent_t</a> *parent);</div><div id="328" class="line none">  328 <a href="rpl.h.html#125">rpl_parent_t</a> *rpl_select_parent(<a href="rpl.h.html#153">rpl_dag_t</a> *<a href="../../ipv6/uip-ds6-route.h.html#157">dag</a>);</div><div id="329" class="line none">  329 <a href="rpl.h.html#153">rpl_dag_t</a> *rpl_select_dag(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>,<a href="rpl.h.html#125">rpl_parent_t</a> *parent);</div><div id="330" class="line none">  330 void rpl_recalculate_ranks(void);</div><div id="331" class="line none">  331 </div><div id="332" class="line none">  332 /* RPL routing table functions. */</div><div id="333" class="line none">  333 void rpl_remove_routes(<a href="rpl.h.html#153">rpl_dag_t</a> *<a href="../../ipv6/uip-ds6-route.h.html#157">dag</a>);</div><div id="334" class="line none">  334 void rpl_remove_routes_by_nexthop(<a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *nexthop, <a href="rpl.h.html#153">rpl_dag_t</a> *<a href="../../ipv6/uip-ds6-route.h.html#157">dag</a>);</div><div id="335" class="line none">  335 <a href="../../ipv6/uip-ds6-route.h.html#184">uip_ds6_route_t</a> *<a href="rpl-private.h.html#335">rpl_add_route</a>(<a href="rpl.h.html#153">rpl_dag_t</a> *<a href="../../ipv6/uip-ds6-route.h.html#157">dag</a>, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *<a href="rpl.h.html#129">prefix</a>,</div><div id="336" class="line none">  336                                int prefix_len, <a href="../../ipv6/uip.h.html#105">uip_ipaddr_t</a> *next_hop);</div><div id="337" class="line none">  337 void rpl_purge_routes(void);</div><div id="338" class="line none">  338 </div><div id="339" class="line none">  339 /* Objective function. */</div><div id="340" class="line none">  340 <a href="rpl.h.html#218">rpl_of_t</a> *rpl_find_of(<a href="rpl.h.html#49">rpl_ocp_t</a>);</div><div id="341" class="line none">  341 </div><div id="342" class="line none">  342 /* Timer functions. */</div><div id="343" class="line none">  343 void rpl_schedule_dao(<a href="rpl.h.html#154">rpl_instance_t</a> *);</div><div id="344" class="line none">  344 void rpl_schedule_dao_immediately(<a href="rpl.h.html#154">rpl_instance_t</a> *);</div><div id="345" class="line none">  345 void rpl_schedule_unicast_dio_immediately(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>);</div><div id="346" class="line none">  346 void rpl_cancel_dao(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>);</div><div id="347" class="line none">  347 void rpl_schedule_probing(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>);</div><div id="348" class="line none">  348 void rpl_schedule_probing_now(<a href="rpl.h.html#154">rpl_instance_t</a> *<a href="../../ipv6/uip.h.html#1631">instance</a>);</div><div id="349" class="line none">  349 </div><div id="350" class="line none">  350 void <a href="rpl-private.h.html#350">rpl_reset_dio_timer</a>(<a href="rpl.h.html#154">rpl_instance_t</a> *);</div><div id="351" class="line none">  351 void rpl_reset_periodic_timer(void);</div><div id="352" class="line none">  352 </div><div id="353" class="line none">  353 /* Route poisoning. */</div><div id="354" class="line none">  354 void rpl_poison_routes(<a href="rpl.h.html#153">rpl_dag_t</a> *, <a href="rpl.h.html#125">rpl_parent_t</a> *);</div><div id="355" class="line none">  355 </div><div id="356" class="line none">  356 <a href="rpl.h.html#154">rpl_instance_t</a> *rpl_get_default_instance(void);</div><div id="357" class="line none">  357 </div><div id="358" class="line none">  358 #endif /* RPL_PRIVATE_H */</div>
</div>
</body>
</html>
