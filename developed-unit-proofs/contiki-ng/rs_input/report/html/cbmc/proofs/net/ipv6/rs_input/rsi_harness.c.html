
<html>
<head>
<title>cbmc/proofs/net/ipv6/rs_input/rsi_harness.c</title>
<link rel="stylesheet" type="text/css" href="../../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /**</div><div id="2" class="line none">    2  * @file rsi_harness.c</div><div id="3" class="line none">    3  * @author Owen Cochell (owencochell@gmail.com)</div><div id="4" class="line none">    4  * @brief Harness for rs_input</div><div id="5" class="line none">    5  * @version 0.1</div><div id="6" class="line none">    6  * @date 2024-07-17</div><div id="7" class="line none">    7  * </div><div id="8" class="line none">    8  * @copyright Copyright (c) 2024</div><div id="9" class="line none">    9  * </div><div id="10" class="line none">   10  */</div><div id="11" class="line none">   11 </div><div id="12" class="line none">   12 #include "contiki.h"</div><div id="13" class="line none">   13 #include "net/ipv6/uip-nd6.h"</div><div id="14" class="line none">   14 #include "net/ipv6/uip-ds6-nbr.h"</div><div id="15" class="line none">   15 </div><div id="16" class="line none">   16 // Header length</div><div id="17" class="line none">   17 uint16_t <a href="rsi_harness.c.html#17">uip_ext_len</a>;</div><div id="18" class="line none">   18 </div><div id="19" class="line none">   19 // Length of payload data</div><div id="20" class="line none">   20 uint16_t <a href="rsi_harness.c.html#20">uip_len</a>;</div><div id="21" class="line none">   21 </div><div id="22" class="line none">   22 <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a> *</div><div id="23" class="line none">   23 <a href="rsi_harness.c.html#23">uip_ds6_nbr_lookup</a>(const <a href="../../../../../os/net/ipv6/uip.h.html#105">uip_ipaddr_t</a> *<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#110">ipaddr</a>) {</div><div id="24" class="line none">   24 </div><div id="25" class="line hit">   25     bool thing;</div><div id="26" class="line none">   26 </div><div id="27" class="line hit">   27     if (thing) {</div><div id="28" class="line hit">   28         return NULL;</div><div id="29" class="line none">   29     }</div><div id="30" class="line none">   30 </div><div id="31" class="line none">   31     // Allocate an NBR type:</div><div id="32" class="line none">   32     // (May be NULL)</div><div id="33" class="line none">   33 </div><div id="34" class="line hit">   34     <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a>* nbrt = (<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a>*)malloc(sizeof(<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a>));</div><div id="35" class="line none">   35 </div><div id="36" class="line none">   36     // IP address will match:</div><div id="37" class="line none">   37 </div><div id="38" class="line hit">   38     nbrt-&gt;<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#110">ipaddr</a> = *<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#110">ipaddr</a>;</div><div id="39" class="line none">   39 </div><div id="40" class="line hit">   40     return nbrt;</div><div id="41" class="line hit">   41 }</div><div id="42" class="line none">   42 </div><div id="43" class="line none">   43 int</div><div id="44" class="line none">   44 <a href="rsi_harness.c.html#44">uip_ds6_nbr_rm</a>(<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a> *<a href="../../../../../os/net/ipv6/uip-nd6.c.html#106">nbr</a>) {</div><div id="45" class="line none">   45 </div><div id="46" class="line none">   46     // Determine if we are NULL:</div><div id="47" class="line none">   47 </div><div id="48" class="line hit">   48     if (<a href="../../../../../os/net/ipv6/uip-nd6.c.html#106">nbr</a> != NULL) {</div><div id="49" class="line none">   49 </div><div id="50" class="line none">   50         // Assume success:</div><div id="51" class="line none">   51 </div><div id="52" class="line hit">   52         return 1;</div><div id="53" class="line none">   53     }</div><div id="54" class="line none">   54 </div><div id="55" class="line missed">   55     return 0;</div><div id="56" class="line hit">   56 }</div><div id="57" class="line none">   57 </div><div id="58" class="line none">   58 <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a> *</div><div id="59" class="line none">   59 <a href="rsi_harness.c.html#59">uip_ds6_nbr_add</a>(const <a href="../../../../../os/net/ipv6/uip.h.html#105">uip_ipaddr_t</a> *<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#110">ipaddr</a>, const <a href="../../../../../os/net/ipv6/uip.h.html#138">uip_lladdr_t</a> *<a href="../../../../../os/net/nbr-table.h.html#93">lladdr</a>,</div><div id="60" class="line none">   60                 uint8_t <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#111">isrouter</a>, uint8_t <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#112">state</a>, <a href="../../../../../os/net/nbr-table.h.html#54">nbr_table_reason_t</a> reason,</div><div id="61" class="line none">   61                 void *<a href="../../../../../os/net/nbr-table.h.html#87">data</a>) {</div><div id="62" class="line none">   62 </div><div id="63" class="line hit">   63     bool thing;</div><div id="64" class="line none">   64 </div><div id="65" class="line hit">   65     if (thing) {</div><div id="66" class="line hit">   66         return NULL;</div><div id="67" class="line none">   67     }</div><div id="68" class="line none">   68 </div><div id="69" class="line none">   69     // Allocate NBR table entry:</div><div id="70" class="line none">   70 </div><div id="71" class="line hit">   71     <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a> *<a href="../../../../../os/net/ipv6/uip-nd6.c.html#106">nbr</a> = (<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a>*)malloc(sizeof(<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a>));</div><div id="72" class="line none">   72 </div><div id="73" class="line none">   73     // IP address MUST be the same as provided:</div><div id="74" class="line none">   74 </div><div id="75" class="line hit">   75     <a href="../../../../../os/net/ipv6/uip-nd6.c.html#106">nbr</a>-&gt;<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#110">ipaddr</a> = *<a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#110">ipaddr</a>;</div><div id="76" class="line none">   76 </div><div id="77" class="line none">   77     // Return entry:</div><div id="78" class="line none">   78 </div><div id="79" class="line hit">   79     return <a href="../../../../../os/net/ipv6/uip-nd6.c.html#106">nbr</a>;</div><div id="80" class="line hit">   80 }</div><div id="81" class="line none">   81 </div><div id="82" class="line none">   82 const <a href="../../../../../os/net/ipv6/uip.h.html#138">uip_lladdr_t</a> *</div><div id="83" class="line none">   83 <a href="rsi_harness.c.html#83">uip_ds6_nbr_get_ll</a>(const <a href="../../../../../os/net/ipv6/uip-ds6-nbr.h.html#122">uip_ds6_nbr_t</a> *<a href="../../../../../os/net/ipv6/uip-nd6.c.html#106">nbr</a>) {</div><div id="84" class="line none">   84 </div><div id="85" class="line none">   85     // Allocate lladdr:</div><div id="86" class="line none">   86 </div><div id="87" class="line hit">   87     <a href="../../../../../os/net/ipv6/uip.h.html#138">uip_lladdr_t</a>* <a href="../../../../../os/net/ipv6/uip-nd6.c.html#107">addr</a> = (<a href="../../../../../os/net/ipv6/uip.h.html#138">uip_lladdr_t</a>*)malloc(sizeof(<a href="../../../../../os/net/ipv6/uip.h.html#138">uip_lladdr_t</a>));</div><div id="88" class="line none">   88 </div><div id="89" class="line hit">   89     return <a href="../../../../../os/net/ipv6/uip-nd6.c.html#107">addr</a>;</div><div id="90" class="line hit">   90 }</div><div id="91" class="line none">   91 </div><div id="92" class="line none">   92 void <a href="rsi_harness.c.html#92">harness</a>() {</div><div id="93" class="line none">   93 </div><div id="94" class="line none">   94     // Payload length will not exceed maximum:</div><div id="95" class="line none">   95 </div><div id="96" class="line hit">   96     __CPROVER_assume(<a href="rsi_harness.c.html#20">uip_len</a> &lt;= UIP_BUFSIZE);</div><div id="97" class="line none">   97 </div><div id="98" class="line none">   98     // Header length will not exceed size:</div><div id="99" class="line none">   99 </div><div id="100" class="line hit">  100     __CPROVER_assume(<a href="rsi_harness.c.html#17">uip_ext_len</a> &lt;= <a href="rsi_harness.c.html#20">uip_len</a> - <a href="../../../../../os/net/ipv6/uip.h.html#56">UIP_IPH_LEN</a>);</div><div id="101" class="line none">  101 </div><div id="102" class="line hit">  102     <a href="../../../../../os/net/ipv6/uip-nd6.c.html#607">rs_input</a>();</div><div id="103" class="line hit">  103 }</div>
</div>
</body>
</html>
