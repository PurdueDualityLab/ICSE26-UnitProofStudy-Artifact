
<html>
<head>
<title>os/sys/process.h</title>
<link rel="stylesheet" type="text/css" href="../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * Copyright (c) 2005, Swedish Institute of Computer Science</div><div id="3" class="line none">    3  * All rights reserved.</div><div id="4" class="line none">    4  *</div><div id="5" class="line none">    5  * Redistribution and use in source and binary forms, with or without</div><div id="6" class="line none">    6  * modification, are permitted provided that the following conditions</div><div id="7" class="line none">    7  * are met:</div><div id="8" class="line none">    8  * 1. Redistributions of source code must retain the above copyright</div><div id="9" class="line none">    9  *    notice, this list of conditions and the following disclaimer.</div><div id="10" class="line none">   10  * 2. Redistributions in binary form must reproduce the above copyright</div><div id="11" class="line none">   11  *    notice, this list of conditions and the following disclaimer in the</div><div id="12" class="line none">   12  *    documentation and/or other materials provided with the distribution.</div><div id="13" class="line none">   13  * 3. Neither the name of the Institute nor the names of its contributors</div><div id="14" class="line none">   14  *    may be used to endorse or promote products derived from this software</div><div id="15" class="line none">   15  *    without specific prior written permission.</div><div id="16" class="line none">   16  *</div><div id="17" class="line none">   17  * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND</div><div id="18" class="line none">   18  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</div><div id="19" class="line none">   19  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</div><div id="20" class="line none">   20  * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE</div><div id="21" class="line none">   21  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</div><div id="22" class="line none">   22  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</div><div id="23" class="line none">   23  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</div><div id="24" class="line none">   24  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</div><div id="25" class="line none">   25  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</div><div id="26" class="line none">   26  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</div><div id="27" class="line none">   27  * SUCH DAMAGE.</div><div id="28" class="line none">   28  *</div><div id="29" class="line none">   29  * This file is part of the Contiki operating system.</div><div id="30" class="line none">   30  *</div><div id="31" class="line none">   31  */</div><div id="32" class="line none">   32 </div><div id="33" class="line none">   33 /**</div><div id="34" class="line none">   34  * \addtogroup threads</div><div id="35" class="line none">   35  * @{</div><div id="36" class="line none">   36  */</div><div id="37" class="line none">   37 </div><div id="38" class="line none">   38 /**</div><div id="39" class="line none">   39  * \defgroup process Contiki processes</div><div id="40" class="line none">   40  *</div><div id="41" class="line none">   41  * A process in Contiki consists of a single protothread.</div><div id="42" class="line none">   42  *</div><div id="43" class="line none">   43  * @{</div><div id="44" class="line none">   44  */</div><div id="45" class="line none">   45 </div><div id="46" class="line none">   46 /**</div><div id="47" class="line none">   47  * \file</div><div id="48" class="line none">   48  * Header file for the Contiki process interface.</div><div id="49" class="line none">   49  * \author</div><div id="50" class="line none">   50  * Adam Dunkels &lt;adam@sics.se&gt;</div><div id="51" class="line none">   51  *</div><div id="52" class="line none">   52  */</div><div id="53" class="line none">   53 #ifndef <a href="process.h.html#54">PROCESS_H_</a></div><div id="54" class="line none">   54 #define <a href="process.h.html#54">PROCESS_H_</a></div><div id="55" class="line none">   55 </div><div id="56" class="line none">   56 #include &lt;stdbool.h&gt;</div><div id="57" class="line none">   57 </div><div id="58" class="line none">   58 #include "sys/pt.h"</div><div id="59" class="line none">   59 #include "sys/cc.h"</div><div id="60" class="line none">   60 </div><div id="61" class="line none">   61 typedef uint8_t       <a href="process.h.html#61">process_event_t</a>;</div><div id="62" class="line none">   62 typedef void *        <a href="process.h.html#62">process_data_t</a>;</div><div id="63" class="line none">   63 typedef uint8_t       <a href="process.h.html#63">process_num_events_t</a>;</div><div id="64" class="line none">   64 </div><div id="65" class="line none">   65 /**</div><div id="66" class="line none">   66  * \name Return values</div><div id="67" class="line none">   67  * @{</div><div id="68" class="line none">   68  */</div><div id="69" class="line none">   69 </div><div id="70" class="line none">   70 /**</div><div id="71" class="line none">   71  * \brief      Return value indicating that an operation was successful.</div><div id="72" class="line none">   72  *</div><div id="73" class="line none">   73  *             This value is returned to indicate that an operation</div><div id="74" class="line none">   74  *             was successful.</div><div id="75" class="line none">   75  */</div><div id="76" class="line none">   76 #define <a href="process.h.html#76">PROCESS_ERR_OK</a>        0</div><div id="77" class="line none">   77 /**</div><div id="78" class="line none">   78  * \brief      Return value indicating that the event queue was full.</div><div id="79" class="line none">   79  *</div><div id="80" class="line none">   80  *             This value is returned from process_post() to indicate</div><div id="81" class="line none">   81  *             that the event queue was full and that an event could</div><div id="82" class="line none">   82  *             not be posted.</div><div id="83" class="line none">   83  */</div><div id="84" class="line none">   84 #define <a href="process.h.html#84">PROCESS_ERR_FULL</a>      1</div><div id="85" class="line none">   85 /** @} */</div><div id="86" class="line none">   86 </div><div id="87" class="line none">   87 #define <a href="process.h.html#87">PROCESS_NONE</a>          NULL</div><div id="88" class="line none">   88 </div><div id="89" class="line none">   89 #ifndef <a href="process.h.html#90">PROCESS_CONF_NUMEVENTS</a></div><div id="90" class="line none">   90 #define <a href="process.h.html#90">PROCESS_CONF_NUMEVENTS</a> 32</div><div id="91" class="line none">   91 #endif /* PROCESS_CONF_NUMEVENTS */</div><div id="92" class="line none">   92 </div><div id="93" class="line none">   93 #define <a href="process.h.html#93">PROCESS_EVENT_NONE</a>            0x80</div><div id="94" class="line none">   94 #define <a href="process.h.html#94">PROCESS_EVENT_INIT</a>            0x81</div><div id="95" class="line none">   95 #define <a href="process.h.html#95">PROCESS_EVENT_POLL</a>            0x82</div><div id="96" class="line none">   96 #define <a href="process.h.html#96">PROCESS_EVENT_EXIT</a>            0x83</div><div id="97" class="line none">   97 #define <a href="process.h.html#97">PROCESS_EVENT_SERVICE_REMOVED</a> 0x84</div><div id="98" class="line none">   98 #define <a href="process.h.html#98">PROCESS_EVENT_CONTINUE</a>        0x85</div><div id="99" class="line none">   99 #define <a href="process.h.html#99">PROCESS_EVENT_MSG</a>             0x86</div><div id="100" class="line none">  100 #define <a href="process.h.html#100">PROCESS_EVENT_EXITED</a>          0x87</div><div id="101" class="line none">  101 #define <a href="process.h.html#101">PROCESS_EVENT_TIMER</a>           0x88</div><div id="102" class="line none">  102 #define <a href="process.h.html#102">PROCESS_EVENT_COM</a>             0x89</div><div id="103" class="line none">  103 #define <a href="process.h.html#103">PROCESS_EVENT_MAX</a>             0x8a</div><div id="104" class="line none">  104 </div><div id="105" class="line none">  105 #define <a href="process.h.html#105">PROCESS_BROADCAST</a> NULL</div><div id="106" class="line none">  106 </div><div id="107" class="line none">  107 /**</div><div id="108" class="line none">  108  * \name Process protothread functions</div><div id="109" class="line none">  109  * @{</div><div id="110" class="line none">  110  */</div><div id="111" class="line none">  111 </div><div id="112" class="line none">  112 /**</div><div id="113" class="line none">  113  * Define the beginning of a process.</div><div id="114" class="line none">  114  *</div><div id="115" class="line none">  115  * This macro defines the beginning of a process, and must always</div><div id="116" class="line none">  116  * appear in a PROCESS_THREAD() definition. The PROCESS_END() macro</div><div id="117" class="line none">  117  * must come at the end of the process.</div><div id="118" class="line none">  118  *</div><div id="119" class="line none">  119  * \hideinitializer</div><div id="120" class="line none">  120  */</div><div id="121" class="line none">  121 #define <a href="process.h.html#121">PROCESS_BEGIN</a>()             <a href="pt.h.html#280">PT_BEGIN</a>(process_pt)</div><div id="122" class="line none">  122 </div><div id="123" class="line none">  123 /**</div><div id="124" class="line none">  124  * Define the end of a process.</div><div id="125" class="line none">  125  *</div><div id="126" class="line none">  126  * This macro defines the end of a process. It must appear in a</div><div id="127" class="line none">  127  * PROCESS_THREAD() definition and must always be included. The</div><div id="128" class="line none">  128  * process exits when the PROCESS_END() macro is reached.</div><div id="129" class="line none">  129  *</div><div id="130" class="line none">  130  * \hideinitializer</div><div id="131" class="line none">  131  */</div><div id="132" class="line none">  132 #define <a href="process.h.html#132">PROCESS_END</a>()               <a href="pt.h.html#292">PT_END</a>(process_pt)</div><div id="133" class="line none">  133 </div><div id="134" class="line none">  134 /**</div><div id="135" class="line none">  135  * Wait for an event to be posted to the process.</div><div id="136" class="line none">  136  *</div><div id="137" class="line none">  137  * This macro blocks the currently running process until the process</div><div id="138" class="line none">  138  * receives an event.</div><div id="139" class="line none">  139  *</div><div id="140" class="line none">  140  * \hideinitializer</div><div id="141" class="line none">  141  */</div><div id="142" class="line none">  142 #define <a href="process.h.html#142">PROCESS_WAIT_EVENT</a>()        <a href="process.h.html#165">PROCESS_YIELD</a>()</div><div id="143" class="line none">  143 </div><div id="144" class="line none">  144 /**</div><div id="145" class="line none">  145  * Wait for an event to be posted to the process, with an extra</div><div id="146" class="line none">  146  * condition.</div><div id="147" class="line none">  147  *</div><div id="148" class="line none">  148  * This macro is similar to PROCESS_WAIT_EVENT() in that it blocks the</div><div id="149" class="line none">  149  * currently running process until the process receives an event. But</div><div id="150" class="line none">  150  * PROCESS_WAIT_EVENT_UNTIL() takes an extra condition which must be</div><div id="151" class="line none">  151  * true for the process to continue.</div><div id="152" class="line none">  152  *</div><div id="153" class="line none">  153  * \param c The condition that must be true for the process to continue.</div><div id="154" class="line none">  154  * \sa PT_WAIT_UNTIL()</div><div id="155" class="line none">  155  *</div><div id="156" class="line none">  156  * \hideinitializer</div><div id="157" class="line none">  157  */</div><div id="158" class="line none">  158 #define <a href="process.h.html#158">PROCESS_WAIT_EVENT_UNTIL</a>(c) <a href="process.h.html#179">PROCESS_YIELD_UNTIL</a>(c)</div><div id="159" class="line none">  159 </div><div id="160" class="line none">  160 /**</div><div id="161" class="line none">  161  * Yield the currently running process.</div><div id="162" class="line none">  162  *</div><div id="163" class="line none">  163  * \hideinitializer</div><div id="164" class="line none">  164  */</div><div id="165" class="line none">  165 #define <a href="process.h.html#165">PROCESS_YIELD</a>()             <a href="pt.h.html#455">PT_YIELD</a>(process_pt)</div><div id="166" class="line none">  166 </div><div id="167" class="line none">  167 /**</div><div id="168" class="line none">  168  * Yield the currently running process until a condition occurs.</div><div id="169" class="line none">  169  *</div><div id="170" class="line none">  170  * This macro is different from PROCESS_WAIT_UNTIL() in that</div><div id="171" class="line none">  171  * PROCESS_YIELD_UNTIL() is guaranteed to always yield at least</div><div id="172" class="line none">  172  * once. This ensures that the process does not end up in an infinite</div><div id="173" class="line none">  173  * loop and monopolizing the CPU.</div><div id="174" class="line none">  174  *</div><div id="175" class="line none">  175  * \param c The condition to wait for.</div><div id="176" class="line none">  176  *</div><div id="177" class="line none">  177  * \hideinitializer</div><div id="178" class="line none">  178  */</div><div id="179" class="line none">  179 #define <a href="process.h.html#179">PROCESS_YIELD_UNTIL</a>(c)      <a href="pt.h.html#475">PT_YIELD_UNTIL</a>(process_pt, c)</div><div id="180" class="line none">  180 </div><div id="181" class="line none">  181 /**</div><div id="182" class="line none">  182  * Wait for a condition to occur.</div><div id="183" class="line none">  183  *</div><div id="184" class="line none">  184  * This macro does not guarantee that the process yields, and should</div><div id="185" class="line none">  185  * therefore be used with care. In most cases, PROCESS_WAIT_EVENT(),</div><div id="186" class="line none">  186  * PROCESS_WAIT_EVENT_UNTIL(), PROCESS_YIELD() or</div><div id="187" class="line none">  187  * PROCESS_YIELD_UNTIL() should be used instead.</div><div id="188" class="line none">  188  *</div><div id="189" class="line none">  189  * \param c The condition to wait for.</div><div id="190" class="line none">  190  *</div><div id="191" class="line none">  191  * \hideinitializer</div><div id="192" class="line none">  192  */</div><div id="193" class="line none">  193 #define <a href="process.h.html#193">PROCESS_WAIT_UNTIL</a>(c)       <a href="pt.h.html#313">PT_WAIT_UNTIL</a>(process_pt, c)</div><div id="194" class="line none">  194 #define <a href="process.h.html#194">PROCESS_WAIT_WHILE</a>(c)       <a href="pt.h.html#332">PT_WAIT_WHILE</a>(process_pt, c)</div><div id="195" class="line none">  195 </div><div id="196" class="line none">  196 /**</div><div id="197" class="line none">  197  * Exit the currently running process.</div><div id="198" class="line none">  198  *</div><div id="199" class="line none">  199  * \hideinitializer</div><div id="200" class="line none">  200  */</div><div id="201" class="line none">  201 #define <a href="process.h.html#201">PROCESS_EXIT</a>()              <a href="pt.h.html#411">PT_EXIT</a>(process_pt)</div><div id="202" class="line none">  202 </div><div id="203" class="line none">  203 /**</div><div id="204" class="line none">  204  * Spawn a protothread from the process.</div><div id="205" class="line none">  205  *</div><div id="206" class="line none">  206  * \param pt The protothread state (struct pt) for the new protothread</div><div id="207" class="line none">  207  * \param thread The call to the protothread function.</div><div id="208" class="line none">  208  * \sa PT_SPAWN()</div><div id="209" class="line none">  209  *</div><div id="210" class="line none">  210  * \hideinitializer</div><div id="211" class="line none">  211  */</div><div id="212" class="line none">  212 #define <a href="process.h.html#212">PROCESS_PT_SPAWN</a>(<a href="pt.h.html#219">pt</a>, thread)   <a href="pt.h.html#371">PT_SPAWN</a>(process_pt, <a href="pt.h.html#219">pt</a>, thread)</div><div id="213" class="line none">  213 </div><div id="214" class="line none">  214 /**</div><div id="215" class="line none">  215  * Yield the process for a short while.</div><div id="216" class="line none">  216  *</div><div id="217" class="line none">  217  * This macro yields the currently running process for a short while,</div><div id="218" class="line none">  218  * thus letting other processes run before the process continues.</div><div id="219" class="line none">  219  *</div><div id="220" class="line none">  220  * \hideinitializer</div><div id="221" class="line none">  221  */</div><div id="222" class="line none">  222 #define <a href="process.h.html#222">PROCESS_PAUSE</a>()             do {                                \</div><div id="223" class="line none">  223   process_post(<a href="process.h.html#404">PROCESS_CURRENT</a>(), <a href="process.h.html#98">PROCESS_EVENT_CONTINUE</a>, NULL);        \</div><div id="224" class="line none">  224   <a href="process.h.html#158">PROCESS_WAIT_EVENT_UNTIL</a>(ev == <a href="process.h.html#98">PROCESS_EVENT_CONTINUE</a>);               \</div><div id="225" class="line none">  225 } while(0)</div><div id="226" class="line none">  226 </div><div id="227" class="line none">  227 /** @} end of protothread functions */</div><div id="228" class="line none">  228 </div><div id="229" class="line none">  229 /**</div><div id="230" class="line none">  230  * \name Poll and exit handlers</div><div id="231" class="line none">  231  * @{</div><div id="232" class="line none">  232  */</div><div id="233" class="line none">  233 /**</div><div id="234" class="line none">  234  * Specify an action when a process is polled.</div><div id="235" class="line none">  235  *</div><div id="236" class="line none">  236  * \note This declaration must come immediately before the</div><div id="237" class="line none">  237  * PROCESS_BEGIN() macro.</div><div id="238" class="line none">  238  *</div><div id="239" class="line none">  239  * \param handler The action to be performed.</div><div id="240" class="line none">  240  *</div><div id="241" class="line none">  241  * \hideinitializer</div><div id="242" class="line none">  242  */</div><div id="243" class="line none">  243 #define <a href="process.h.html#243">PROCESS_POLLHANDLER</a>(<a href="../net/ipv6/uip-icmp6.h.html#181">handler</a>) if(ev == <a href="process.h.html#95">PROCESS_EVENT_POLL</a>) { <a href="../net/ipv6/uip-icmp6.h.html#181">handler</a>; }</div><div id="244" class="line none">  244 </div><div id="245" class="line none">  245 /**</div><div id="246" class="line none">  246  * Specify an action when a process exits.</div><div id="247" class="line none">  247  *</div><div id="248" class="line none">  248  * \note This declaration must come immediately before the</div><div id="249" class="line none">  249  * PROCESS_BEGIN() macro.</div><div id="250" class="line none">  250  *</div><div id="251" class="line none">  251  * \param handler The action to be performed.</div><div id="252" class="line none">  252  *</div><div id="253" class="line none">  253  * \hideinitializer</div><div id="254" class="line none">  254  */</div><div id="255" class="line none">  255 #define <a href="process.h.html#255">PROCESS_EXITHANDLER</a>(<a href="../net/ipv6/uip-icmp6.h.html#181">handler</a>) if(ev == <a href="process.h.html#96">PROCESS_EVENT_EXIT</a>) { <a href="../net/ipv6/uip-icmp6.h.html#181">handler</a>; }</div><div id="256" class="line none">  256 </div><div id="257" class="line none">  257 /** @} */</div><div id="258" class="line none">  258 </div><div id="259" class="line none">  259 /**</div><div id="260" class="line none">  260  * \name Process declaration and definition</div><div id="261" class="line none">  261  * @{</div><div id="262" class="line none">  262  */</div><div id="263" class="line none">  263 </div><div id="264" class="line none">  264 /**</div><div id="265" class="line none">  265  * Define the body of a process.</div><div id="266" class="line none">  266  *</div><div id="267" class="line none">  267  * This macro is used to define the body (protothread) of a</div><div id="268" class="line none">  268  * process. The process is called whenever an event occurs in the</div><div id="269" class="line none">  269  * system, A process always start with the PROCESS_BEGIN() macro and</div><div id="270" class="line none">  270  * end with the PROCESS_END() macro.</div><div id="271" class="line none">  271  *</div><div id="272" class="line none">  272  * \hideinitializer</div><div id="273" class="line none">  273  */</div><div id="274" class="line none">  274 #define <a href="process.h.html#274">PROCESS_THREAD</a>(<a href="log.h.html#104">name</a>, ev, <a href="../net/nbr-table.h.html#87">data</a>)                          \</div><div id="275" class="line none">  275 static <a href="pt.h.html#265">PT_THREAD</a>(process_thread_##<a href="log.h.html#104">name</a>(struct <a href="pt.h.html#219">pt</a> *process_pt,   \</div><div id="276" class="line none">  276                                        <a href="process.h.html#61">process_event_t</a> ev,      \</div><div id="277" class="line none">  277                                        <a href="process.h.html#62">process_data_t</a> <a href="../net/nbr-table.h.html#87">data</a>))</div><div id="278" class="line none">  278 </div><div id="279" class="line none">  279 /**</div><div id="280" class="line none">  280  * Declare the name of a process.</div><div id="281" class="line none">  281  *</div><div id="282" class="line none">  282  * This macro is typically used in header files to declare the name of</div><div id="283" class="line none">  283  * a process that is implemented in the C file.</div><div id="284" class="line none">  284  *</div><div id="285" class="line none">  285  * \hideinitializer</div><div id="286" class="line none">  286  */</div><div id="287" class="line none">  287 #define <a href="process.h.html#287">PROCESS_NAME</a>(<a href="log.h.html#104">name</a>) extern struct <a href="process.h.html#316">process</a> <a href="log.h.html#104">name</a></div><div id="288" class="line none">  288 </div><div id="289" class="line none">  289 /**</div><div id="290" class="line none">  290  * Declare a process.</div><div id="291" class="line none">  291  *</div><div id="292" class="line none">  292  * This macro declares a process. The process has two names: the</div><div id="293" class="line none">  293  * variable of the process structure, which is used by the C program,</div><div id="294" class="line none">  294  * and a human readable string name, which is used when debugging.</div><div id="295" class="line none">  295  * A configuration option allows removal of the readable name to save RAM.</div><div id="296" class="line none">  296  *</div><div id="297" class="line none">  297  * \param name The variable name of the process structure.</div><div id="298" class="line none">  298  * \param strname The string representation of the process' name.</div><div id="299" class="line none">  299  *</div><div id="300" class="line none">  300  * \hideinitializer</div><div id="301" class="line none">  301  */</div><div id="302" class="line none">  302 #if PROCESS_CONF_NO_PROCESS_NAMES</div><div id="303" class="line none">  303 #define <a href="process.h.html#303">PROCESS</a>(<a href="log.h.html#104">name</a>, strname)                          \</div><div id="304" class="line none">  304   <a href="process.h.html#274">PROCESS_THREAD</a>(<a href="log.h.html#104">name</a>, ev, <a href="../net/nbr-table.h.html#87">data</a>);                       \</div><div id="305" class="line none">  305   struct <a href="process.h.html#316">process</a> <a href="log.h.html#104">name</a> = { NULL,                 \</div><div id="306" class="line none">  306                           process_thread_##<a href="log.h.html#104">name</a>, {0}, 0, 0 }</div><div id="307" class="line none">  307 #else</div><div id="308" class="line none">  308 #define <a href="process.h.html#303">PROCESS</a>(<a href="log.h.html#104">name</a>, strname)                          \</div><div id="309" class="line none">  309   <a href="process.h.html#274">PROCESS_THREAD</a>(<a href="log.h.html#104">name</a>, ev, <a href="../net/nbr-table.h.html#87">data</a>);                       \</div><div id="310" class="line none">  310   struct <a href="process.h.html#316">process</a> <a href="log.h.html#104">name</a> = { NULL, strname,                \</div><div id="311" class="line none">  311                           process_thread_##<a href="log.h.html#104">name</a>, {0}, 0, 0 }</div><div id="312" class="line none">  312 #endif</div><div id="313" class="line none">  313 </div><div id="314" class="line none">  314 /** @} */</div><div id="315" class="line none">  315 </div><div id="316" class="line none">  316 struct <a href="process.h.html#316">process</a> {</div><div id="317" class="line none">  317   struct <a href="process.h.html#316">process</a> *<a href="../net/ipv6/uip-ds6-nbr.h.html#107">next</a>;</div><div id="318" class="line none">  318 #if PROCESS_CONF_NO_PROCESS_NAMES</div><div id="319" class="line none">  319 #define <a href="process.h.html#319">PROCESS_NAME_STRING</a>(<a href="process.h.html#316">process</a>) ""</div><div id="320" class="line none">  320 #else</div><div id="321" class="line none">  321   const char *<a href="log.h.html#104">name</a>;</div><div id="322" class="line none">  322 #define <a href="process.h.html#319">PROCESS_NAME_STRING</a>(<a href="process.h.html#316">process</a>) ((<a href="process.h.html#316">process</a>) != NULL ? (<a href="process.h.html#316">process</a>)-&gt;<a href="log.h.html#104">name</a> : "")</div><div id="323" class="line none">  323 #endif</div><div id="324" class="line none">  324   <a href="pt.h.html#265">PT_THREAD</a>((* thread)(struct <a href="pt.h.html#219">pt</a> *, <a href="process.h.html#61">process_event_t</a>, <a href="process.h.html#62">process_data_t</a>));</div><div id="325" class="line none">  325   struct <a href="pt.h.html#219">pt</a> <a href="pt.h.html#219">pt</a>;</div><div id="326" class="line none">  326   uint8_t <a href="../net/ipv6/uip-ds6-nbr.h.html#112">state</a>;</div><div id="327" class="line none">  327   bool <a href="process.h.html#327">needspoll</a>;</div><div id="328" class="line none">  328 };</div><div id="329" class="line none">  329 </div><div id="330" class="line none">  330 /**</div><div id="331" class="line none">  331  * \name Functions called from application programs</div><div id="332" class="line none">  332  * @{</div><div id="333" class="line none">  333  */</div><div id="334" class="line none">  334 </div><div id="335" class="line none">  335 /**</div><div id="336" class="line none">  336  * Start a process.</div><div id="337" class="line none">  337  *</div><div id="338" class="line none">  338  * \param p A pointer to a process structure.</div><div id="339" class="line none">  339  *</div><div id="340" class="line none">  340  * \param data An argument pointer that can be passed to the new</div><div id="341" class="line none">  341  * process</div><div id="342" class="line none">  342  *</div><div id="343" class="line none">  343  */</div><div id="344" class="line none">  344 void process_start(struct <a href="process.h.html#316">process</a> *<a href="ctimer.h.html#66">p</a>, <a href="process.h.html#62">process_data_t</a> <a href="../net/nbr-table.h.html#87">data</a>);</div><div id="345" class="line none">  345 </div><div id="346" class="line none">  346 /**</div><div id="347" class="line none">  347  * Post an asynchronous event.</div><div id="348" class="line none">  348  *</div><div id="349" class="line none">  349  * This function posts an asynchronous event to one or more</div><div id="350" class="line none">  350  * processes. The handing of the event is deferred until the target</div><div id="351" class="line none">  351  * process is scheduled by the kernel. An event can be broadcast to</div><div id="352" class="line none">  352  * all processes, in which case all processes in the system will be</div><div id="353" class="line none">  353  * scheduled to handle the event.</div><div id="354" class="line none">  354  *</div><div id="355" class="line none">  355  * \param ev The event to be posted.</div><div id="356" class="line none">  356  *</div><div id="357" class="line none">  357  * \param data The auxiliary data to be sent with the event</div><div id="358" class="line none">  358  *</div><div id="359" class="line none">  359  * \param p The process to which the event should be posted, or</div><div id="360" class="line none">  360  * PROCESS_BROADCAST if the event should be posted to all processes.</div><div id="361" class="line none">  361  *</div><div id="362" class="line none">  362  * \retval PROCESS_ERR_OK The event could be posted.</div><div id="363" class="line none">  363  *</div><div id="364" class="line none">  364  * \retval PROCESS_ERR_FULL The event queue was full and the event could</div><div id="365" class="line none">  365  * not be posted.</div><div id="366" class="line none">  366  */</div><div id="367" class="line none">  367 int process_post(struct <a href="process.h.html#316">process</a> *<a href="ctimer.h.html#66">p</a>, <a href="process.h.html#61">process_event_t</a> ev, <a href="process.h.html#62">process_data_t</a> <a href="../net/nbr-table.h.html#87">data</a>);</div><div id="368" class="line none">  368 </div><div id="369" class="line none">  369 /**</div><div id="370" class="line none">  370  * Post a synchronous event to a process.</div><div id="371" class="line none">  371  *</div><div id="372" class="line none">  372  * \param p A pointer to the process' process structure.</div><div id="373" class="line none">  373  *</div><div id="374" class="line none">  374  * \param ev The event to be posted.</div><div id="375" class="line none">  375  *</div><div id="376" class="line none">  376  * \param data A pointer to additional data that is posted together</div><div id="377" class="line none">  377  * with the event.</div><div id="378" class="line none">  378  */</div><div id="379" class="line none">  379 void process_post_synch(struct <a href="process.h.html#316">process</a> *<a href="ctimer.h.html#66">p</a>,</div><div id="380" class="line none">  380                         <a href="process.h.html#61">process_event_t</a> ev, <a href="process.h.html#62">process_data_t</a> <a href="../net/nbr-table.h.html#87">data</a>);</div><div id="381" class="line none">  381 </div><div id="382" class="line none">  382 /**</div><div id="383" class="line none">  383  * \brief      Cause a process to exit</div><div id="384" class="line none">  384  * \param p    The process that is to be exited</div><div id="385" class="line none">  385  *</div><div id="386" class="line none">  386  *             This function causes a process to exit. The process can</div><div id="387" class="line none">  387  *             either be the currently executing process, or another</div><div id="388" class="line none">  388  *             process that is currently running.</div><div id="389" class="line none">  389  *</div><div id="390" class="line none">  390  * \sa PROCESS_CURRENT()</div><div id="391" class="line none">  391  */</div><div id="392" class="line none">  392 void process_exit(struct <a href="process.h.html#316">process</a> *<a href="ctimer.h.html#66">p</a>);</div><div id="393" class="line none">  393 </div><div id="394" class="line none">  394 </div><div id="395" class="line none">  395 /**</div><div id="396" class="line none">  396  * Get a pointer to the currently running process.</div><div id="397" class="line none">  397  *</div><div id="398" class="line none">  398  * This macro get a pointer to the currently running</div><div id="399" class="line none">  399  * process. Typically, this macro is used to post an event to the</div><div id="400" class="line none">  400  * current process with process_post().</div><div id="401" class="line none">  401  *</div><div id="402" class="line none">  402  * \hideinitializer</div><div id="403" class="line none">  403  */</div><div id="404" class="line none">  404 #define <a href="process.h.html#404">PROCESS_CURRENT</a>() process_current</div><div id="405" class="line none">  405 extern struct <a href="process.h.html#316">process</a> *process_current;</div><div id="406" class="line none">  406 </div><div id="407" class="line none">  407 /**</div><div id="408" class="line none">  408  * Switch context to another process</div><div id="409" class="line none">  409  *</div><div id="410" class="line none">  410  * This function switch context to the specified process and executes</div><div id="411" class="line none">  411  * the code as if run by that process. Typical use of this function is</div><div id="412" class="line none">  412  * to switch context in services, called by other processes. Each</div><div id="413" class="line none">  413  * PROCESS_CONTEXT_BEGIN() must be followed by the</div><div id="414" class="line none">  414  * PROCESS_CONTEXT_END() macro to end the context switch.</div><div id="415" class="line none">  415  *</div><div id="416" class="line none">  416  * Example:</div><div id="417" class="line none">  417  \code</div><div id="418" class="line none">  418  PROCESS_CONTEXT_BEGIN(&amp;test_process);</div><div id="419" class="line none">  419  etimer_set(&amp;timer, CLOCK_SECOND);</div><div id="420" class="line none">  420  PROCESS_CONTEXT_END(&amp;test_process);</div><div id="421" class="line none">  421  \endcode</div><div id="422" class="line none">  422  *</div><div id="423" class="line none">  423  * \param p    The process to use as context</div><div id="424" class="line none">  424  *</div><div id="425" class="line none">  425  * \sa PROCESS_CONTEXT_END()</div><div id="426" class="line none">  426  * \sa PROCESS_CURRENT()</div><div id="427" class="line none">  427  */</div><div id="428" class="line none">  428 #define <a href="process.h.html#428">PROCESS_CONTEXT_BEGIN</a>(<a href="ctimer.h.html#66">p</a>) {\</div><div id="429" class="line none">  429 struct <a href="process.h.html#316">process</a> *tmp_current = <a href="process.h.html#404">PROCESS_CURRENT</a>();\</div><div id="430" class="line none">  430 process_current = <a href="ctimer.h.html#66">p</a></div><div id="431" class="line none">  431 </div><div id="432" class="line none">  432 /**</div><div id="433" class="line none">  433  * End a context switch</div><div id="434" class="line none">  434  *</div><div id="435" class="line none">  435  * This function ends a context switch and changes back to the</div><div id="436" class="line none">  436  * previous process.</div><div id="437" class="line none">  437  *</div><div id="438" class="line none">  438  * \param p    The process used in the context switch</div><div id="439" class="line none">  439  *</div><div id="440" class="line none">  440  * \sa PROCESS_CONTEXT_START()</div><div id="441" class="line none">  441  */</div><div id="442" class="line none">  442 #define <a href="process.h.html#442">PROCESS_CONTEXT_END</a>(<a href="ctimer.h.html#66">p</a>) process_current = tmp_current; }</div><div id="443" class="line none">  443 </div><div id="444" class="line none">  444 /**</div><div id="445" class="line none">  445  * \brief      Allocate a global event number.</div><div id="446" class="line none">  446  * \return     The allocated event number on success,</div><div id="447" class="line none">  447  *             or PROCESS_EVENT_NONE on failure.</div><div id="448" class="line none">  448  *</div><div id="449" class="line none">  449  *             In Contiki, event numbers above 128 are global and may</div><div id="450" class="line none">  450  *             be posted from one process to another. This function</div><div id="451" class="line none">  451  *             allocates one such event number.</div><div id="452" class="line none">  452  *</div><div id="453" class="line none">  453  * \note       There currently is no way to deallocate an allocated event</div><div id="454" class="line none">  454  *             number.</div><div id="455" class="line none">  455 </div><div id="456" class="line none">  456  * \note       For local events within a module, there is no need to</div><div id="457" class="line none">  457  *             allocate the event number using this function. One can</div><div id="458" class="line none">  458  *             simply use an arbitrary event number in the range of</div><div id="459" class="line none">  459  *             0 - 127 for this purpose.</div><div id="460" class="line none">  460  */</div><div id="461" class="line none">  461 <a href="process.h.html#61">process_event_t</a> process_alloc_event(void);</div><div id="462" class="line none">  462 </div><div id="463" class="line none">  463 /** @} */</div><div id="464" class="line none">  464 </div><div id="465" class="line none">  465 /**</div><div id="466" class="line none">  466  * \name Functions called from device drivers</div><div id="467" class="line none">  467  * @{</div><div id="468" class="line none">  468  */</div><div id="469" class="line none">  469 </div><div id="470" class="line none">  470 /**</div><div id="471" class="line none">  471  * Request a process to be polled.</div><div id="472" class="line none">  472  *</div><div id="473" class="line none">  473  * This function typically is called from an interrupt handler to</div><div id="474" class="line none">  474  * cause a process to be polled.</div><div id="475" class="line none">  475  *</div><div id="476" class="line none">  476  * \param p A pointer to the process' process structure.</div><div id="477" class="line none">  477  */</div><div id="478" class="line none">  478 void process_poll(struct <a href="process.h.html#316">process</a> *<a href="ctimer.h.html#66">p</a>);</div><div id="479" class="line none">  479 </div><div id="480" class="line none">  480 /** @} */</div><div id="481" class="line none">  481 </div><div id="482" class="line none">  482 /**</div><div id="483" class="line none">  483  * \name Functions called by the system and boot-up code</div><div id="484" class="line none">  484  * @{</div><div id="485" class="line none">  485  */</div><div id="486" class="line none">  486 </div><div id="487" class="line none">  487 /**</div><div id="488" class="line none">  488  * \brief      Initialize the process module.</div><div id="489" class="line none">  489  *</div><div id="490" class="line none">  490  *             This function initializes the process module and should</div><div id="491" class="line none">  491  *             be called by the system boot-up code.</div><div id="492" class="line none">  492  */</div><div id="493" class="line none">  493 void process_init(void);</div><div id="494" class="line none">  494 </div><div id="495" class="line none">  495 /**</div><div id="496" class="line none">  496  * Run the system once - call poll handlers and process one event.</div><div id="497" class="line none">  497  *</div><div id="498" class="line none">  498  * This function should be called repeatedly from the main() program</div><div id="499" class="line none">  499  * to actually run the Contiki system. It calls the necessary poll</div><div id="500" class="line none">  500  * handlers, and processes one event. The function returns the number</div><div id="501" class="line none">  501  * of events that are waiting in the event queue so that the caller</div><div id="502" class="line none">  502  * may choose to put the CPU to sleep when there are no pending</div><div id="503" class="line none">  503  * events.</div><div id="504" class="line none">  504  *</div><div id="505" class="line none">  505  * \return The number of events that are currently waiting in the</div><div id="506" class="line none">  506  * event queue.</div><div id="507" class="line none">  507  */</div><div id="508" class="line none">  508 <a href="process.h.html#63">process_num_events_t</a> process_run(void);</div><div id="509" class="line none">  509 </div><div id="510" class="line none">  510 </div><div id="511" class="line none">  511 /**</div><div id="512" class="line none">  512  * Check if a process is running.</div><div id="513" class="line none">  513  *</div><div id="514" class="line none">  514  * This function checks if a specific process is running.</div><div id="515" class="line none">  515  *</div><div id="516" class="line none">  516  * \param p The process.</div><div id="517" class="line none">  517  * \retval true if the process is running.</div><div id="518" class="line none">  518  * \retval false if the process is not running.</div><div id="519" class="line none">  519  */</div><div id="520" class="line none">  520 bool process_is_running(struct <a href="process.h.html#316">process</a> *<a href="ctimer.h.html#66">p</a>);</div><div id="521" class="line none">  521 </div><div id="522" class="line none">  522 /**</div><div id="523" class="line none">  523  *  Number of events waiting to be processed.</div><div id="524" class="line none">  524  *</div><div id="525" class="line none">  525  * \return The number of events that are currently waiting to be</div><div id="526" class="line none">  526  * processed.</div><div id="527" class="line none">  527  */</div><div id="528" class="line none">  528 <a href="process.h.html#63">process_num_events_t</a> process_nevents(void);</div><div id="529" class="line none">  529 </div><div id="530" class="line none">  530 /** @} */</div><div id="531" class="line none">  531 </div><div id="532" class="line none">  532 extern struct <a href="process.h.html#316">process</a> *process_list;</div><div id="533" class="line none">  533 </div><div id="534" class="line none">  534 #define <a href="process.h.html#534">PROCESS_LIST</a>() process_list</div><div id="535" class="line none">  535 </div><div id="536" class="line none">  536 #endif /* PROCESS_H_ */</div><div id="537" class="line none">  537 </div><div id="538" class="line none">  538 /** @} */</div><div id="539" class="line none">  539 /** @} */</div>
</div>
</body>
</html>
