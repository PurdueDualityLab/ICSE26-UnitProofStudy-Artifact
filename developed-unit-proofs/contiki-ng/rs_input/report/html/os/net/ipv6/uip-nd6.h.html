
<html>
<head>
<title>os/net/ipv6/uip-nd6.h</title>
<link rel="stylesheet" type="text/css" href="../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * Copyright (c) 2006, Swedish Institute of Computer Science.</div><div id="3" class="line none">    3  * All rights reserved.</div><div id="4" class="line none">    4  *</div><div id="5" class="line none">    5  * Redistribution and use in source and binary forms, with or without</div><div id="6" class="line none">    6  * modification, are permitted provided that the following conditions</div><div id="7" class="line none">    7  * are met:</div><div id="8" class="line none">    8  * 1. Redistributions of source code must retain the above copyright</div><div id="9" class="line none">    9  *    notice, this list of conditions and the following disclaimer.</div><div id="10" class="line none">   10  * 2. Redistributions in binary form must reproduce the above copyright</div><div id="11" class="line none">   11  *    notice, this list of conditions and the following disclaimer in the</div><div id="12" class="line none">   12  *    documentation and/or other materials provided with the distribution.</div><div id="13" class="line none">   13  * 3. Neither the name of the Institute nor the names of its contributors</div><div id="14" class="line none">   14  *    may be used to endorse or promote products derived from this software</div><div id="15" class="line none">   15  *    without specific prior written permission.</div><div id="16" class="line none">   16  *</div><div id="17" class="line none">   17  * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND</div><div id="18" class="line none">   18  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</div><div id="19" class="line none">   19  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</div><div id="20" class="line none">   20  * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE</div><div id="21" class="line none">   21  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</div><div id="22" class="line none">   22  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</div><div id="23" class="line none">   23  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</div><div id="24" class="line none">   24  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</div><div id="25" class="line none">   25  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</div><div id="26" class="line none">   26  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</div><div id="27" class="line none">   27  * SUCH DAMAGE.</div><div id="28" class="line none">   28  *</div><div id="29" class="line none">   29  * This file is part of the Contiki operating system.</div><div id="30" class="line none">   30  *</div><div id="31" class="line none">   31  */</div><div id="32" class="line none">   32 </div><div id="33" class="line none">   33 /**</div><div id="34" class="line none">   34  * \addtogroup uip</div><div id="35" class="line none">   35  * @{</div><div id="36" class="line none">   36  */</div><div id="37" class="line none">   37 </div><div id="38" class="line none">   38 /**</div><div id="39" class="line none">   39  * \file</div><div id="40" class="line none">   40  *    Header file for IPv6 Neighbor discovery (RFC 4861)</div><div id="41" class="line none">   41  * \author Julien Abeille &lt;jabeille@cisco.com&gt;</div><div id="42" class="line none">   42  * \author Mathilde Durvy &lt;mdurvy@cisco.com&gt;</div><div id="43" class="line none">   43  */</div><div id="44" class="line none">   44 </div><div id="45" class="line none">   45 #ifndef <a href="uip-nd6.h.html#46">UIP_ND6_H_</a></div><div id="46" class="line none">   46 #define <a href="uip-nd6.h.html#46">UIP_ND6_H_</a></div><div id="47" class="line none">   47 </div><div id="48" class="line none">   48 #include "net/ipv6/uip.h"</div><div id="49" class="line none">   49 #include "sys/stimer.h"</div><div id="50" class="line none">   50 /**</div><div id="51" class="line none">   51  *  \name General</div><div id="52" class="line none">   52  * @{</div><div id="53" class="line none">   53  */</div><div id="54" class="line none">   54 /** \brief HOP LIMIT to be used when sending ND messages (255) */</div><div id="55" class="line none">   55 #define <a href="uip-nd6.h.html#55">UIP_ND6_HOP_LIMIT</a>               255</div><div id="56" class="line none">   56 /** \brief INFINITE lifetime */</div><div id="57" class="line none">   57 #define <a href="uip-nd6.h.html#57">UIP_ND6_INFINITE_LIFETIME</a>       0xFFFFFFFF</div><div id="58" class="line none">   58 /** @} */</div><div id="59" class="line none">   59 </div><div id="60" class="line none">   60 /** \name RFC 4861 Host constant */</div><div id="61" class="line none">   61 /** @{ */</div><div id="62" class="line none">   62 /** \brief Maximum router solicitation delay */</div><div id="63" class="line none">   63 #ifndef UIP_CONF_ND6_MAX_RTR_SOLICITATION_DELAY</div><div id="64" class="line none">   64 #define <a href="uip-nd6.h.html#64">UIP_ND6_MAX_RTR_SOLICITATION_DELAY</a> 1</div><div id="65" class="line none">   65 #else</div><div id="66" class="line none">   66 #define <a href="uip-nd6.h.html#64">UIP_ND6_MAX_RTR_SOLICITATION_DELAY</a> UIP_CONF_ND6_MAX_RTR_SOLICITATION_DELAY</div><div id="67" class="line none">   67 #endif</div><div id="68" class="line none">   68 /** \brief Router solicitation interval */</div><div id="69" class="line none">   69 #ifndef UIP_CONF_ND6_RTR_SOLICITATION_INTERVAL</div><div id="70" class="line none">   70 #define <a href="uip-nd6.h.html#70">UIP_ND6_RTR_SOLICITATION_INTERVAL</a>  4</div><div id="71" class="line none">   71 #else</div><div id="72" class="line none">   72 #define <a href="uip-nd6.h.html#70">UIP_ND6_RTR_SOLICITATION_INTERVAL</a>  UIP_CONF_ND6_RTR_SOLICITATION_INTERVAL</div><div id="73" class="line none">   73 #endif</div><div id="74" class="line none">   74 /** \brief Maximum router solicitations */</div><div id="75" class="line none">   75 #ifndef UIP_CONF_ND6_MAX_RTR_SOLICITATIONS</div><div id="76" class="line none">   76 #define <a href="uip-nd6.h.html#76">UIP_ND6_MAX_RTR_SOLICITATIONS</a>      3</div><div id="77" class="line none">   77 #else</div><div id="78" class="line none">   78 #define <a href="uip-nd6.h.html#76">UIP_ND6_MAX_RTR_SOLICITATIONS</a>      UIP_CONF_ND6_MAX_RTR_SOLICITATIONS</div><div id="79" class="line none">   79 #endif</div><div id="80" class="line none">   80 /** @} */</div><div id="81" class="line none">   81 </div><div id="82" class="line none">   82 /** \name RFC 4861 Router constants */</div><div id="83" class="line none">   83 /** @{ */</div><div id="84" class="line none">   84 #ifndef UIP_CONF_ND6_SEND_RA</div><div id="85" class="line none">   85 #define <a href="uip-nd6.h.html#85">UIP_ND6_SEND_RA</a>                     1   /* enable/disable RA sending */</div><div id="86" class="line none">   86 #else</div><div id="87" class="line none">   87 #define <a href="uip-nd6.h.html#85">UIP_ND6_SEND_RA</a> UIP_CONF_ND6_SEND_RA</div><div id="88" class="line none">   88 #endif</div><div id="89" class="line none">   89 #ifndef UIP_CONF_ND6_SEND_NS</div><div id="90" class="line none">   90 #define <a href="uip-nd6.h.html#90">UIP_ND6_SEND_NS</a>                     1   /* enable/disable NS sending */</div><div id="91" class="line none">   91 #else</div><div id="92" class="line none">   92 #define <a href="uip-nd6.h.html#90">UIP_ND6_SEND_NS</a> UIP_CONF_ND6_SEND_NS</div><div id="93" class="line none">   93 #endif</div><div id="94" class="line none">   94 #ifndef UIP_CONF_ND6_SEND_NA</div><div id="95" class="line none">   95 #define <a href="uip-nd6.h.html#95">UIP_ND6_SEND_NA</a>                     1   /* enable/disable NA sending */</div><div id="96" class="line none">   96 #else</div><div id="97" class="line none">   97 #define <a href="uip-nd6.h.html#95">UIP_ND6_SEND_NA</a> UIP_CONF_ND6_SEND_NA</div><div id="98" class="line none">   98 #endif</div><div id="99" class="line none">   99 #ifndef UIP_CONF_ND6_AUTOFILL_NBR_CACHE</div><div id="100" class="line none">  100 /* Neighbor not found in cache? Derive its link-layer address from it's</div><div id="101" class="line none">  101 link-local IPv6, assuming it used autoconfiguration. This is not</div><div id="102" class="line none">  102 standard-compliant but this is a convenient way to keep the</div><div id="103" class="line none">  103 neighbor cache out of the way in cases ND is not used.</div><div id="104" class="line none">  104 Note that this is not standard-compliant (RFC 4861), as neighbors will</div><div id="105" class="line none">  105 be added regardless of their reachability and liveness.  */</div><div id="106" class="line none">  106 #define <a href="uip-nd6.h.html#106">UIP_ND6_AUTOFILL_NBR_CACHE</a>          0</div><div id="107" class="line none">  107 #else</div><div id="108" class="line none">  108 #define <a href="uip-nd6.h.html#106">UIP_ND6_AUTOFILL_NBR_CACHE</a> UIP_CONF_ND6_AUTOFILL_NBR_CACHE</div><div id="109" class="line none">  109 #endif</div><div id="110" class="line none">  110 #ifndef UIP_CONF_ND6_MAX_RA_INTERVAL</div><div id="111" class="line none">  111 #define <a href="uip-nd6.h.html#111">UIP_ND6_MAX_RA_INTERVAL</a>             600</div><div id="112" class="line none">  112 #else</div><div id="113" class="line none">  113 #define <a href="uip-nd6.h.html#111">UIP_ND6_MAX_RA_INTERVAL</a>             UIP_CONF_ND6_MAX_RA_INTERVAL</div><div id="114" class="line none">  114 #endif</div><div id="115" class="line none">  115 #ifndef UIP_CONF_ND6_MIN_RA_INTERVAL</div><div id="116" class="line none">  116 #define <a href="uip-nd6.h.html#116">UIP_ND6_MIN_RA_INTERVAL</a>             (<a href="uip-nd6.h.html#111">UIP_ND6_MAX_RA_INTERVAL</a> / 3)</div><div id="117" class="line none">  117 #else</div><div id="118" class="line none">  118 #define <a href="uip-nd6.h.html#116">UIP_ND6_MIN_RA_INTERVAL</a>             UIP_CONF_ND6_MIN_RA_INTERVAL</div><div id="119" class="line none">  119 #endif</div><div id="120" class="line none">  120 #define <a href="uip-nd6.h.html#120">UIP_ND6_M_FLAG</a>                      0</div><div id="121" class="line none">  121 #define <a href="uip-nd6.h.html#121">UIP_ND6_O_FLAG</a>                      0</div><div id="122" class="line none">  122 #ifndef UIP_CONF_ROUTER_LIFETIME</div><div id="123" class="line none">  123 #define <a href="uip-nd6.h.html#123">UIP_ND6_ROUTER_LIFETIME</a>             3 * <a href="uip-nd6.h.html#111">UIP_ND6_MAX_RA_INTERVAL</a></div><div id="124" class="line none">  124 #else</div><div id="125" class="line none">  125 #define <a href="uip-nd6.h.html#123">UIP_ND6_ROUTER_LIFETIME</a>             UIP_CONF_ROUTER_LIFETIME</div><div id="126" class="line none">  126 #endif</div><div id="127" class="line none">  127 </div><div id="128" class="line none">  128 #define <a href="uip-nd6.h.html#128">UIP_ND6_MAX_INITIAL_RA_INTERVAL</a>     16  /*seconds*/</div><div id="129" class="line none">  129 #define <a href="uip-nd6.h.html#129">UIP_ND6_MAX_INITIAL_RAS</a>             3   /*transmissions*/</div><div id="130" class="line none">  130 #ifndef UIP_CONF_ND6_MIN_DELAY_BETWEEN_RAS</div><div id="131" class="line none">  131 #define <a href="uip-nd6.h.html#131">UIP_ND6_MIN_DELAY_BETWEEN_RAS</a>       3   /*seconds*/</div><div id="132" class="line none">  132 #else</div><div id="133" class="line none">  133 #define <a href="uip-nd6.h.html#131">UIP_ND6_MIN_DELAY_BETWEEN_RAS</a>       UIP_CONF_ND6_MIN_DELAY_BETWEEN_RAS</div><div id="134" class="line none">  134 #endif</div><div id="135" class="line none">  135 //#define UIP_ND6_MAX_RA_DELAY_TIME           0.5 /*seconds*/</div><div id="136" class="line none">  136 #define <a href="uip-nd6.h.html#136">UIP_ND6_MAX_RA_DELAY_TIME_MS</a>        500 /*milli seconds*/</div><div id="137" class="line none">  137 /** @} */</div><div id="138" class="line none">  138 </div><div id="139" class="line none">  139 #ifndef UIP_CONF_ND6_DEF_MAXDADNS</div><div id="140" class="line none">  140 /** \brief Do not try DAD when using EUI-64 as allowed by draft-ietf-6lowpan-nd-15 section 8.2 */</div><div id="141" class="line none">  141 #if <a href="uip.h.html#132">UIP_CONF_LL_802154</a></div><div id="142" class="line none">  142 #define <a href="uip-nd6.h.html#142">UIP_ND6_DEF_MAXDADNS</a> 0</div><div id="143" class="line none">  143 #else /* UIP_CONF_LL_802154 */</div><div id="144" class="line none">  144 #define <a href="uip-nd6.h.html#142">UIP_ND6_DEF_MAXDADNS</a> <a href="uip-nd6.h.html#90">UIP_ND6_SEND_NS</a></div><div id="145" class="line none">  145 #endif /* UIP_CONF_LL_802154 */</div><div id="146" class="line none">  146 #else /* UIP_CONF_ND6_DEF_MAXDADNS */</div><div id="147" class="line none">  147 #define <a href="uip-nd6.h.html#142">UIP_ND6_DEF_MAXDADNS</a> UIP_CONF_ND6_DEF_MAXDADNS</div><div id="148" class="line none">  148 #endif /* UIP_CONF_ND6_DEF_MAXDADNS */</div><div id="149" class="line none">  149 </div><div id="150" class="line none">  150 /** \name RFC 4861 Node constant */</div><div id="151" class="line none">  151 #define <a href="uip-nd6.h.html#151">UIP_ND6_MAX_MULTICAST_SOLICIT</a>  3</div><div id="152" class="line none">  152 </div><div id="153" class="line none">  153 #ifdef UIP_CONF_ND6_MAX_UNICAST_SOLICIT</div><div id="154" class="line none">  154 #define <a href="uip-nd6.h.html#154">UIP_ND6_MAX_UNICAST_SOLICIT</a>    UIP_CONF_ND6_MAX_UNICAST_SOLICIT</div><div id="155" class="line none">  155 #else /* UIP_CONF_ND6_MAX_UNICAST_SOLICIT */</div><div id="156" class="line none">  156 #define <a href="uip-nd6.h.html#154">UIP_ND6_MAX_UNICAST_SOLICIT</a>    3</div><div id="157" class="line none">  157 #endif /* UIP_CONF_ND6_MAX_UNICAST_SOLICIT */</div><div id="158" class="line none">  158 </div><div id="159" class="line none">  159 #ifdef UIP_CONF_ND6_REACHABLE_TIME</div><div id="160" class="line none">  160 #define <a href="uip-nd6.h.html#160">UIP_ND6_REACHABLE_TIME</a>         UIP_CONF_ND6_REACHABLE_TIME</div><div id="161" class="line none">  161 #else</div><div id="162" class="line none">  162 #define <a href="uip-nd6.h.html#160">UIP_ND6_REACHABLE_TIME</a>         60000</div><div id="163" class="line none">  163 #endif</div><div id="164" class="line none">  164 </div><div id="165" class="line none">  165 #ifdef UIP_CONF_ND6_RETRANS_TIMER</div><div id="166" class="line none">  166 #define <a href="uip-nd6.h.html#166">UIP_ND6_RETRANS_TIMER</a>          UIP_CONF_ND6_RETRANS_TIMER</div><div id="167" class="line none">  167 #else</div><div id="168" class="line none">  168 #define <a href="uip-nd6.h.html#166">UIP_ND6_RETRANS_TIMER</a>          1000</div><div id="169" class="line none">  169 #endif</div><div id="170" class="line none">  170 </div><div id="171" class="line none">  171 #define <a href="uip-nd6.h.html#171">UIP_ND6_DELAY_FIRST_PROBE_TIME</a> 5</div><div id="172" class="line none">  172 #define <a href="uip-nd6.h.html#172">UIP_ND6_MIN_RANDOM_FACTOR</a>(x)   (x / 2)</div><div id="173" class="line none">  173 #define <a href="uip-nd6.h.html#173">UIP_ND6_MAX_RANDOM_FACTOR</a>(x)   ((x) + (x) / 2)</div><div id="174" class="line none">  174 /** @} */</div><div id="175" class="line none">  175 </div><div id="176" class="line none">  176 </div><div id="177" class="line none">  177 /** \name RFC 6106 RA DNS Options Constants  */</div><div id="178" class="line none">  178 /** @{ */</div><div id="179" class="line none">  179 #ifndef UIP_CONF_ND6_RA_RDNSS</div><div id="180" class="line none">  180 #define <a href="uip-nd6.h.html#180">UIP_ND6_RA_RDNSS</a>                0</div><div id="181" class="line none">  181 #else</div><div id="182" class="line none">  182 #define <a href="uip-nd6.h.html#180">UIP_ND6_RA_RDNSS</a>                UIP_CONF_ND6_RA_RDNSS</div><div id="183" class="line none">  183 #endif</div><div id="184" class="line none">  184 </div><div id="185" class="line none">  185 #ifndef UIP_CONF_ND6_RA_DNSSL</div><div id="186" class="line none">  186 #define <a href="uip-nd6.h.html#186">UIP_ND6_RA_DNSSL</a>                0</div><div id="187" class="line none">  187 #else</div><div id="188" class="line none">  188 #error Not implemented</div><div id="189" class="line none">  189 #define <a href="uip-nd6.h.html#186">UIP_ND6_RA_DNSSL</a>                UIP_CONF_ND6_RA_DNSSL</div><div id="190" class="line none">  190 #endif</div><div id="191" class="line none">  191 /** @} */</div><div id="192" class="line none">  192 </div><div id="193" class="line none">  193 </div><div id="194" class="line none">  194 /** \name ND6 option types */</div><div id="195" class="line none">  195 /** @{ */</div><div id="196" class="line none">  196 #define <a href="uip-nd6.h.html#196">UIP_ND6_OPT_SLLAO</a>               1</div><div id="197" class="line none">  197 #define <a href="uip-nd6.h.html#197">UIP_ND6_OPT_TLLAO</a>               2</div><div id="198" class="line none">  198 #define <a href="uip-nd6.h.html#198">UIP_ND6_OPT_PREFIX_INFO</a>         3</div><div id="199" class="line none">  199 #define <a href="uip-nd6.h.html#199">UIP_ND6_OPT_REDIRECTED_HDR</a>      4</div><div id="200" class="line none">  200 #define <a href="uip-nd6.h.html#200">UIP_ND6_OPT_MTU</a>                 5</div><div id="201" class="line none">  201 #define <a href="uip-nd6.h.html#201">UIP_ND6_OPT_RDNSS</a>               25</div><div id="202" class="line none">  202 #define <a href="uip-nd6.h.html#202">UIP_ND6_OPT_DNSSL</a>               31</div><div id="203" class="line none">  203 /** @} */</div><div id="204" class="line none">  204 </div><div id="205" class="line none">  205 /** \name ND6 option types */</div><div id="206" class="line none">  206 /** @{ */</div><div id="207" class="line none">  207 #define <a href="uip-nd6.h.html#207">UIP_ND6_OPT_TYPE_OFFSET</a>         0</div><div id="208" class="line none">  208 #define <a href="uip-nd6.h.html#208">UIP_ND6_OPT_LEN_OFFSET</a>          1</div><div id="209" class="line none">  209 #define <a href="uip-nd6.h.html#209">UIP_ND6_OPT_DATA_OFFSET</a>         2</div><div id="210" class="line none">  210 </div><div id="211" class="line none">  211 /** \name ND6 message length (excluding options) */</div><div id="212" class="line none">  212 /** @{ */</div><div id="213" class="line none">  213 #define <a href="uip-nd6.h.html#213">UIP_ND6_NA_LEN</a>                  20</div><div id="214" class="line none">  214 #define <a href="uip-nd6.h.html#214">UIP_ND6_NS_LEN</a>                  20</div><div id="215" class="line none">  215 #define <a href="uip-nd6.h.html#215">UIP_ND6_RA_LEN</a>                  12</div><div id="216" class="line none">  216 #define <a href="uip-nd6.h.html#216">UIP_ND6_RS_LEN</a>                  4</div><div id="217" class="line none">  217 /** @} */</div><div id="218" class="line none">  218 </div><div id="219" class="line none">  219 </div><div id="220" class="line none">  220 /** \name ND6 option length in bytes */</div><div id="221" class="line none">  221 /** @{ */</div><div id="222" class="line none">  222 #define <a href="uip-nd6.h.html#222">UIP_ND6_OPT_HDR_LEN</a>            2</div><div id="223" class="line none">  223 #define <a href="uip-nd6.h.html#223">UIP_ND6_OPT_PREFIX_INFO_LEN</a>    32</div><div id="224" class="line none">  224 #define <a href="uip-nd6.h.html#224">UIP_ND6_OPT_MTU_LEN</a>            8</div><div id="225" class="line none">  225 #define <a href="uip-nd6.h.html#225">UIP_ND6_OPT_RDNSS_LEN</a>          1</div><div id="226" class="line none">  226 #define <a href="uip-nd6.h.html#226">UIP_ND6_OPT_DNSSL_LEN</a>          1</div><div id="227" class="line none">  227 </div><div id="228" class="line none">  228 </div><div id="229" class="line none">  229 /* Length of TLLAO and SLLAO options, it is L2 dependant */</div><div id="230" class="line none">  230 #if <a href="uip.h.html#132">UIP_CONF_LL_802154</a></div><div id="231" class="line none">  231 /* If the interface is 802.15.4. For now we use only long addresses */</div><div id="232" class="line none">  232 #define <a href="uip-nd6.h.html#232">UIP_ND6_OPT_SHORT_LLAO_LEN</a>     8</div><div id="233" class="line none">  233 #define <a href="uip-nd6.h.html#233">UIP_ND6_OPT_LONG_LLAO_LEN</a>      16</div><div id="234" class="line none">  234 /** \brief length of a ND6 LLAO option for 802.15.4 */</div><div id="235" class="line none">  235 #define <a href="uip-nd6.h.html#235">UIP_ND6_OPT_LLAO_LEN</a> <a href="uip-nd6.h.html#233">UIP_ND6_OPT_LONG_LLAO_LEN</a></div><div id="236" class="line none">  236 #else /*UIP_CONF_LL_802154*/</div><div id="237" class="line none">  237 #if UIP_CONF_LL_80211</div><div id="238" class="line none">  238 /* If the interface is 802.11 */</div><div id="239" class="line none">  239 /** \brief length of a ND6 LLAO option for 802.11 */</div><div id="240" class="line none">  240 #define <a href="uip-nd6.h.html#235">UIP_ND6_OPT_LLAO_LEN</a>           8</div><div id="241" class="line none">  241 #else /*UIP_CONF_LL_80211*/</div><div id="242" class="line none">  242 /** \brief length of a ND6 LLAO option for default L2 type (e.g. Ethernet) */</div><div id="243" class="line none">  243 #define <a href="uip-nd6.h.html#235">UIP_ND6_OPT_LLAO_LEN</a>           8</div><div id="244" class="line none">  244 #endif /*UIP_CONF_LL_80211*/</div><div id="245" class="line none">  245 #endif /*UIP_CONF_LL_802154*/</div><div id="246" class="line none">  246 /** @} */</div><div id="247" class="line none">  247 </div><div id="248" class="line none">  248 </div><div id="249" class="line none">  249 /** \name Neighbor Advertisement flags masks */</div><div id="250" class="line none">  250 /** @{ */</div><div id="251" class="line none">  251 #define <a href="uip-nd6.h.html#251">UIP_ND6_NA_FLAG_ROUTER</a>          0x80</div><div id="252" class="line none">  252 #define <a href="uip-nd6.h.html#252">UIP_ND6_NA_FLAG_SOLICITED</a>       0x40</div><div id="253" class="line none">  253 #define <a href="uip-nd6.h.html#253">UIP_ND6_NA_FLAG_OVERRIDE</a>        0x20</div><div id="254" class="line none">  254 #define <a href="uip-nd6.h.html#254">UIP_ND6_RA_FLAG_ONLINK</a>          0x80</div><div id="255" class="line none">  255 #define <a href="uip-nd6.h.html#255">UIP_ND6_RA_FLAG_AUTONOMOUS</a>      0x40</div><div id="256" class="line none">  256 /** @} */</div><div id="257" class="line none">  257 </div><div id="258" class="line none">  258 /**</div><div id="259" class="line none">  259  * \name ND message structures</div><div id="260" class="line none">  260  * @{</div><div id="261" class="line none">  261  */</div><div id="262" class="line none">  262 </div><div id="263" class="line none">  263 /**</div><div id="264" class="line none">  264  * \brief A neighbor solicitation constant part</div><div id="265" class="line none">  265  *</div><div id="266" class="line none">  266  * Possible option is: SLLAO</div><div id="267" class="line none">  267  */</div><div id="268" class="line none">  268 typedef struct <a href="uip-nd6.h.html#268">uip_nd6_ns</a> {</div><div id="269" class="line none">  269   uint32_t <a href="uip-nd6.h.html#269">reserved</a>;</div><div id="270" class="line none">  270   <a href="uip.h.html#105">uip_ipaddr_t</a> <a href="uip-nd6.h.html#270">tgtipaddr</a>;</div><div id="271" class="line none">  271 } <a href="uip-nd6.h.html#268">uip_nd6_ns</a>;</div><div id="272" class="line none">  272 </div><div id="273" class="line none">  273 /**</div><div id="274" class="line none">  274  * \brief A neighbor advertisement constant part.</div><div id="275" class="line none">  275  *</div><div id="276" class="line none">  276  * Possible option is: TLLAO</div><div id="277" class="line none">  277  */</div><div id="278" class="line none">  278 typedef struct <a href="uip-nd6.h.html#278">uip_nd6_na</a> {</div><div id="279" class="line none">  279   uint8_t <a href="uip-nd6.h.html#279">flagsreserved</a>;</div><div id="280" class="line none">  280   uint8_t <a href="uip-nd6.h.html#269">reserved</a>[3];</div><div id="281" class="line none">  281   <a href="uip.h.html#105">uip_ipaddr_t</a> <a href="uip-nd6.h.html#270">tgtipaddr</a>;</div><div id="282" class="line none">  282 } <a href="uip-nd6.h.html#278">uip_nd6_na</a>;</div><div id="283" class="line none">  283 </div><div id="284" class="line none">  284 /**</div><div id="285" class="line none">  285  * \brief A router solicitation  constant part</div><div id="286" class="line none">  286  *</div><div id="287" class="line none">  287  * Possible option is: SLLAO</div><div id="288" class="line none">  288  */</div><div id="289" class="line none">  289 typedef struct <a href="uip-nd6.h.html#289">uip_nd6_rs</a> {</div><div id="290" class="line none">  290   uint32_t <a href="uip-nd6.h.html#269">reserved</a>;</div><div id="291" class="line none">  291 } <a href="uip-nd6.h.html#289">uip_nd6_rs</a>;</div><div id="292" class="line none">  292 </div><div id="293" class="line none">  293 /**</div><div id="294" class="line none">  294  * \brief A router advertisement constant part</div><div id="295" class="line none">  295  *</div><div id="296" class="line none">  296  * Possible options are: SLLAO, MTU, Prefix Information</div><div id="297" class="line none">  297  */</div><div id="298" class="line none">  298 typedef struct <a href="uip-nd6.h.html#298">uip_nd6_ra</a> {</div><div id="299" class="line none">  299   uint8_t <a href="uip-nd6.h.html#299">cur_ttl</a>;</div><div id="300" class="line none">  300   uint8_t <a href="uip-nd6.h.html#300">flags_reserved</a>;</div><div id="301" class="line none">  301   uint16_t <a href="uip-nd6.h.html#301">router_lifetime</a>;</div><div id="302" class="line none">  302   uint32_t <a href="uip-ds6.h.html#234">reachable_time</a>;</div><div id="303" class="line none">  303   uint32_t <a href="uip-ds6.h.html#235">retrans_timer</a>;</div><div id="304" class="line none">  304 } <a href="uip-nd6.h.html#298">uip_nd6_ra</a>;</div><div id="305" class="line none">  305 </div><div id="306" class="line none">  306 /**</div><div id="307" class="line none">  307  * \brief A redirect message constant part</div><div id="308" class="line none">  308  *</div><div id="309" class="line none">  309  * Possible options are: TLLAO, redirected header</div><div id="310" class="line none">  310  */</div><div id="311" class="line none">  311 typedef struct <a href="uip-nd6.h.html#311">uip_nd6_redirect</a> {</div><div id="312" class="line none">  312   uint32_t <a href="uip-nd6.h.html#269">reserved</a>;</div><div id="313" class="line none">  313   <a href="uip.h.html#105">uip_ipaddr_t</a> <a href="uip-nd6.h.html#313">tgtipaddress</a>;</div><div id="314" class="line none">  314   <a href="uip.h.html#105">uip_ipaddr_t</a> <a href="uip-nd6.h.html#314">destipaddress</a>;</div><div id="315" class="line none">  315 } <a href="uip-nd6.h.html#311">uip_nd6_redirect</a>;</div><div id="316" class="line none">  316 /** @} */</div><div id="317" class="line none">  317 </div><div id="318" class="line none">  318 /**</div><div id="319" class="line none">  319  * \name ND Option structures</div><div id="320" class="line none">  320  * @{</div><div id="321" class="line none">  321  */</div><div id="322" class="line none">  322 </div><div id="323" class="line none">  323 /** \brief ND option header */</div><div id="324" class="line none">  324 typedef struct <a href="uip-nd6.h.html#324">uip_nd6_opt_hdr</a> {</div><div id="325" class="line none">  325   uint8_t <a href="uip-ds6.h.html#209">type</a>;</div><div id="326" class="line none">  326   uint8_t <a href="uip-nd6.h.html#326">len</a>;</div><div id="327" class="line none">  327 } <a href="uip-nd6.h.html#324">uip_nd6_opt_hdr</a>;</div><div id="328" class="line none">  328 </div><div id="329" class="line none">  329 /** \brief ND option prefix information */</div><div id="330" class="line none">  330 typedef struct <a href="uip-nd6.h.html#330">uip_nd6_opt_prefix_info</a> {</div><div id="331" class="line none">  331   uint8_t <a href="uip-ds6.h.html#209">type</a>;</div><div id="332" class="line none">  332   uint8_t <a href="uip-nd6.h.html#326">len</a>;</div><div id="333" class="line none">  333   uint8_t <a href="uip-nd6.h.html#333">preflen</a>;</div><div id="334" class="line none">  334   uint8_t <a href="uip-nd6.h.html#334">flagsreserved1</a>;</div><div id="335" class="line none">  335   uint32_t <a href="uip-nd6.h.html#335">validlt</a>;</div><div id="336" class="line none">  336   uint32_t <a href="uip-nd6.h.html#336">preferredlt</a>;</div><div id="337" class="line none">  337   uint32_t <a href="uip-nd6.h.html#337">reserved2</a>;</div><div id="338" class="line none">  338   <a href="uip.h.html#105">uip_ipaddr_t</a> <a href="uip-nd6.c.html#119">prefix</a>;</div><div id="339" class="line none">  339 } <a href="uip-nd6.h.html#330">uip_nd6_opt_prefix_info</a> ;</div><div id="340" class="line none">  340 </div><div id="341" class="line none">  341 /** \brief ND option MTU */</div><div id="342" class="line none">  342 typedef struct <a href="uip-nd6.h.html#342">uip_nd6_opt_mtu</a> {</div><div id="343" class="line none">  343   uint8_t <a href="uip-ds6.h.html#209">type</a>;</div><div id="344" class="line none">  344   uint8_t <a href="uip-nd6.h.html#326">len</a>;</div><div id="345" class="line none">  345   uint16_t <a href="uip-nd6.h.html#269">reserved</a>;</div><div id="346" class="line none">  346   uint32_t <a href="uip-nd6.h.html#346">mtu</a>;</div><div id="347" class="line none">  347 } <a href="uip-nd6.h.html#342">uip_nd6_opt_mtu</a>;</div><div id="348" class="line none">  348 </div><div id="349" class="line none">  349 /** \brief ND option RDNSS */</div><div id="350" class="line none">  350 typedef struct <a href="uip-nd6.h.html#350">uip_nd6_opt_dns</a> {</div><div id="351" class="line none">  351   uint8_t <a href="uip-ds6.h.html#209">type</a>;</div><div id="352" class="line none">  352   uint8_t <a href="uip-nd6.h.html#326">len</a>;</div><div id="353" class="line none">  353   uint16_t <a href="uip-nd6.h.html#269">reserved</a>;</div><div id="354" class="line none">  354   uint32_t <a href="uip-nd6.h.html#354">lifetime</a>;</div><div id="355" class="line none">  355   <a href="uip.h.html#105">uip_ipaddr_t</a> <a href="uip-nd6.h.html#355">ip</a>;</div><div id="356" class="line none">  356 } <a href="uip-nd6.h.html#350">uip_nd6_opt_dns</a>;</div><div id="357" class="line none">  357 </div><div id="358" class="line none">  358 /** \struct Redirected header option */</div><div id="359" class="line none">  359 typedef struct <a href="uip-nd6.h.html#359">uip_nd6_opt_redirected_hdr</a> {</div><div id="360" class="line none">  360   uint8_t <a href="uip-ds6.h.html#209">type</a>;</div><div id="361" class="line none">  361   uint8_t <a href="uip-nd6.h.html#326">len</a>;</div><div id="362" class="line none">  362   uint8_t <a href="uip-nd6.h.html#269">reserved</a>[6];</div><div id="363" class="line none">  363 } <a href="uip-nd6.h.html#359">uip_nd6_opt_redirected_hdr</a>;</div><div id="364" class="line none">  364 /** @} */</div><div id="365" class="line none">  365 </div><div id="366" class="line none">  366 /**</div><div id="367" class="line none">  367  * \name ND Messages Processing and Generation</div><div id="368" class="line none">  368  * @{</div><div id="369" class="line none">  369  */</div><div id="370" class="line none">  370  /**</div><div id="371" class="line none">  371  * \brief Send a neighbor solicitation, send a Neighbor Advertisement</div><div id="372" class="line none">  372  * \param src pointer to the src of the NS if known</div><div id="373" class="line none">  373  * \param dest pointer to ip address to send the NS, for DAD or ADDR Resol,</div><div id="374" class="line none">  374  * MUST be NULL, for NUD, must be correct unicast dest</div><div id="375" class="line none">  375  * \param tgt  pointer to ip address to fill the target address field, must</div><div id="376" class="line none">  376  * not be NULL</div><div id="377" class="line none">  377  *</div><div id="378" class="line none">  378  * - RFC 4861, 7.2.2 :</div><div id="379" class="line none">  379  *   "If the source address of the packet prompting the solicitation is the</div><div id="380" class="line none">  380  *   same as one of the addresses assigned to the outgoing interface, that</div><div id="381" class="line none">  381  *   address SHOULD be placed in the IP Source Address of the outgoing</div><div id="382" class="line none">  382  *   solicitation.  Otherwise, any one of the addresses assigned to the</div><div id="383" class="line none">  383  *   interface should be used."</div><div id="384" class="line none">  384  *   This is why we have a src ip address as argument. If NULL, we will do</div><div id="385" class="line none">  385  *   src address selection, otherwise we use the argument.</div><div id="386" class="line none">  386  *</div><div id="387" class="line none">  387  * - we check if it is a NS for Address resolution  or NUD, if yes we include</div><div id="388" class="line none">  388  *   a SLLAO option, otherwise no.</div><div id="389" class="line none">  389  */</div><div id="390" class="line none">  390 void</div><div id="391" class="line none">  391 <a href="uip-nd6.c.html#367">uip_nd6_ns_output</a>(const <a href="uip.h.html#105">uip_ipaddr_t</a> *<a href="uip.h.html#1428">src</a>, const <a href="uip.h.html#105">uip_ipaddr_t</a> *<a href="uip.h.html#1427">dest</a>,</div><div id="392" class="line none">  392                   <a href="uip.h.html#105">uip_ipaddr_t</a> *tgt);</div><div id="393" class="line none">  393 </div><div id="394" class="line none">  394 #if UIP_CONF_ROUTER</div><div id="395" class="line none">  395 #if <a href="uip-nd6.h.html#85">UIP_ND6_SEND_RA</a></div><div id="396" class="line none">  396 /**</div><div id="397" class="line none">  397  * \brief send a Router Advertisement</div><div id="398" class="line none">  398  *</div><div id="399" class="line none">  399  * Only for router, for periodic as well as sollicited RA</div><div id="400" class="line none">  400  */</div><div id="401" class="line none">  401 void <a href="uip-nd6.c.html#703">uip_nd6_ra_output</a>(const <a href="uip.h.html#105">uip_ipaddr_t</a> *<a href="uip.h.html#1427">dest</a>);</div><div id="402" class="line none">  402 #endif /* UIP_ND6_SEND_RA */</div><div id="403" class="line none">  403 #endif /*UIP_CONF_ROUTER*/</div><div id="404" class="line none">  404 </div><div id="405" class="line none">  405 /**</div><div id="406" class="line none">  406  * \brief Send a Router Solicitation</div><div id="407" class="line none">  407  *</div><div id="408" class="line none">  408  * src is chosen through the uip_netif_select_src function. If src is</div><div id="409" class="line none">  409  * unspecified  (i.e. we do not have a preferred address yet), then we do not</div><div id="410" class="line none">  410  * put a SLLAO option (MUST NOT in RFC 4861). Otherwise we do.</div><div id="411" class="line none">  411  *</div><div id="412" class="line none">  412  * RS message format,</div><div id="413" class="line none">  413  * possible option is SLLAO, MUST NOT be included if source = unspecified</div><div id="414" class="line none">  414  * SHOULD be included otherwise</div><div id="415" class="line none">  415  */</div><div id="416" class="line none">  416 void <a href="uip-nd6.c.html#810">uip_nd6_rs_output</a>(void);</div><div id="417" class="line none">  417 </div><div id="418" class="line none">  418 /**</div><div id="419" class="line none">  419  * \brief Initialise the uIP ND core</div><div id="420" class="line none">  420  */</div><div id="421" class="line none">  421 void <a href="uip-nd6.c.html#1108">uip_nd6_init</a>(void);</div><div id="422" class="line none">  422 /** @} */</div><div id="423" class="line none">  423 </div><div id="424" class="line none">  424 </div><div id="425" class="line none">  425 void</div><div id="426" class="line none">  426 uip_appserver_addr_get(<a href="uip.h.html#105">uip_ipaddr_t</a> *<a href="uip-ds6-nbr.h.html#110">ipaddr</a>);</div><div id="427" class="line none">  427 /*--------------------------------------*/</div><div id="428" class="line none">  428 /******* ANNEX - message formats ********/</div><div id="429" class="line none">  429 /*--------------------------------------*/</div><div id="430" class="line none">  430 </div><div id="431" class="line none">  431 /*</div><div id="432" class="line none">  432  * RS format. possible option is SLLAO</div><div id="433" class="line none">  433  *    0                   1                   2                   3</div><div id="434" class="line none">  434  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="435" class="line none">  435  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="436" class="line none">  436  *    |     Type      |     Code      |          Checksum             |</div><div id="437" class="line none">  437  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="438" class="line none">  438  *    |                            Reserved                           |</div><div id="439" class="line none">  439  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="440" class="line none">  440  *    |   Options ...</div><div id="441" class="line none">  441  *    +-+-+-+-+-+-+-+-+-+-+-+-</div><div id="442" class="line none">  442  *</div><div id="443" class="line none">  443  *</div><div id="444" class="line none">  444  * RA format. possible options: prefix information, MTU, SLLAO</div><div id="445" class="line none">  445  *    0                   1                   2                   3</div><div id="446" class="line none">  446  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="447" class="line none">  447  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="448" class="line none">  448  *    |     Type      |     Code      |          Checksum             |</div><div id="449" class="line none">  449  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="450" class="line none">  450  *    | Cur Hop Limit |M|O|  Reserved |       Router Lifetime         |</div><div id="451" class="line none">  451  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="452" class="line none">  452  *    |                         Reachable Time                        |</div><div id="453" class="line none">  453  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="454" class="line none">  454  *    |                          Retrans Timer                        |</div><div id="455" class="line none">  455  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="456" class="line none">  456  *    |   Options ...</div><div id="457" class="line none">  457  *    +-+-+-+-+-+-+-+-+-+-+-+-</div><div id="458" class="line none">  458  *</div><div id="459" class="line none">  459  *</div><div id="460" class="line none">  460  * NS format: options should be SLLAO</div><div id="461" class="line none">  461  *    0                   1                   2                   3</div><div id="462" class="line none">  462  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="463" class="line none">  463  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="464" class="line none">  464  *    |     Type      |     Code      |          Checksum             |</div><div id="465" class="line none">  465  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="466" class="line none">  466  *    |                           Reserved                            |</div><div id="467" class="line none">  467  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="468" class="line none">  468  *    |                                                               |</div><div id="469" class="line none">  469  *    +                                                               +</div><div id="470" class="line none">  470  *    |                                                               |</div><div id="471" class="line none">  471  *    +                       Target Address                          +</div><div id="472" class="line none">  472  *    |                                                               |</div><div id="473" class="line none">  473  *    +                                                               +</div><div id="474" class="line none">  474  *    |                                                               |</div><div id="475" class="line none">  475  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="476" class="line none">  476  *    |   Options ...</div><div id="477" class="line none">  477  *    +-+-+-+-+-+-+-+-+-+-+-+-</div><div id="478" class="line none">  478  *</div><div id="479" class="line none">  479  *</div><div id="480" class="line none">  480  * NA message format. possible options is TLLAO</div><div id="481" class="line none">  481  *</div><div id="482" class="line none">  482  *    0                   1                   2                   3</div><div id="483" class="line none">  483  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="484" class="line none">  484  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="485" class="line none">  485  *    |     Type      |     Code      |          Checksum             |</div><div id="486" class="line none">  486  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="487" class="line none">  487  *    |R|S|O|                     Reserved                            |</div><div id="488" class="line none">  488  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="489" class="line none">  489  *    |                                                               |</div><div id="490" class="line none">  490  *    +                                                               +</div><div id="491" class="line none">  491  *    |                                                               |</div><div id="492" class="line none">  492  *    +                       Target Address                          +</div><div id="493" class="line none">  493  *    |                                                               |</div><div id="494" class="line none">  494  *    +                                                               +</div><div id="495" class="line none">  495  *    |                                                               |</div><div id="496" class="line none">  496  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="497" class="line none">  497  *    |   Options ...</div><div id="498" class="line none">  498  *    +-+-+-+-+-+-+-+-+-+-+-+-</div><div id="499" class="line none">  499  *</div><div id="500" class="line none">  500  *</div><div id="501" class="line none">  501  * Redirect message format. Possible options are TLLAO and Redirected header</div><div id="502" class="line none">  502  *</div><div id="503" class="line none">  503  *    0                   1                   2                   3</div><div id="504" class="line none">  504  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="505" class="line none">  505  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="506" class="line none">  506  *    |     Type      |     Code      |          Checksum             |</div><div id="507" class="line none">  507  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="508" class="line none">  508  *    |                           Reserved                            |</div><div id="509" class="line none">  509  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="510" class="line none">  510  *    |                                                               |</div><div id="511" class="line none">  511  *    +                                                               +</div><div id="512" class="line none">  512  *    |                                                               |</div><div id="513" class="line none">  513  *    +                       Target Address                          +</div><div id="514" class="line none">  514  *    |                                                               |</div><div id="515" class="line none">  515  *    +                                                               +</div><div id="516" class="line none">  516  *    |                                                               |</div><div id="517" class="line none">  517  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="518" class="line none">  518  *    |                                                               |</div><div id="519" class="line none">  519  *    +                                                               +</div><div id="520" class="line none">  520  *    |                                                               |</div><div id="521" class="line none">  521  *    +                     Destination Address                       +</div><div id="522" class="line none">  522  *    |                                                               |</div><div id="523" class="line none">  523  *    +                                                               +</div><div id="524" class="line none">  524  *    |                                                               |</div><div id="525" class="line none">  525  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="526" class="line none">  526  *    |   Options ...</div><div id="527" class="line none">  527  *    +-+-+-+-+-+-+-+-+-+-+-+-</div><div id="528" class="line none">  528  *</div><div id="529" class="line none">  529  *</div><div id="530" class="line none">  530  * SLLAO/TLLAO option:</div><div id="531" class="line none">  531  *    0                   1                   2                   3</div><div id="532" class="line none">  532  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="533" class="line none">  533  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="534" class="line none">  534  *    |     Type      |    Length     |    Link-Layer Address ...</div><div id="535" class="line none">  535  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="536" class="line none">  536  *</div><div id="537" class="line none">  537  *</div><div id="538" class="line none">  538  * Prefix information option</div><div id="539" class="line none">  539  *    0                   1                   2                   3</div><div id="540" class="line none">  540  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="541" class="line none">  541  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="542" class="line none">  542  *    |     Type      |    Length     | Prefix Length |L|A| Reserved1 |</div><div id="543" class="line none">  543  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="544" class="line none">  544  *    |                         Valid Lifetime                        |</div><div id="545" class="line none">  545  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="546" class="line none">  546  *    |                       Preferred Lifetime                      |</div><div id="547" class="line none">  547  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="548" class="line none">  548  *    |                           Reserved2                           |</div><div id="549" class="line none">  549  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="550" class="line none">  550  *    |                                                               |</div><div id="551" class="line none">  551  *    +                                                               +</div><div id="552" class="line none">  552  *    |                                                               |</div><div id="553" class="line none">  553  *    +                            Prefix                             +</div><div id="554" class="line none">  554  *    |                                                               |</div><div id="555" class="line none">  555  *    +                                                               +</div><div id="556" class="line none">  556  *    |                                                               |</div><div id="557" class="line none">  557  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="558" class="line none">  558  *</div><div id="559" class="line none">  559  *</div><div id="560" class="line none">  560  * MTU option</div><div id="561" class="line none">  561  *    0                   1                   2                   3</div><div id="562" class="line none">  562  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="563" class="line none">  563  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="564" class="line none">  564  *    |     Type      |    Length     |           Reserved            |</div><div id="565" class="line none">  565  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="566" class="line none">  566  *    |                              MTU                              |</div><div id="567" class="line none">  567  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="568" class="line none">  568  *</div><div id="569" class="line none">  569  *</div><div id="570" class="line none">  570  * Redirected header option</div><div id="571" class="line none">  571  *</div><div id="572" class="line none">  572  *    0                   1                   2                   3</div><div id="573" class="line none">  573  *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</div><div id="574" class="line none">  574  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="575" class="line none">  575  *    |     Type      |    Length     |            Reserved           |</div><div id="576" class="line none">  576  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="577" class="line none">  577  *    |                           Reserved                            |</div><div id="578" class="line none">  578  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="579" class="line none">  579  *    |                                                               |</div><div id="580" class="line none">  580  *    ~                       IP header + data                        ~</div><div id="581" class="line none">  581  *    |                                                               |</div><div id="582" class="line none">  582  *    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</div><div id="583" class="line none">  583  *</div><div id="584" class="line none">  584  */</div><div id="585" class="line none">  585 #endif /* UIP_ND6_H_ */</div><div id="586" class="line none">  586 </div><div id="587" class="line none">  587 /** @} */</div>
</div>
</body>
</html>
