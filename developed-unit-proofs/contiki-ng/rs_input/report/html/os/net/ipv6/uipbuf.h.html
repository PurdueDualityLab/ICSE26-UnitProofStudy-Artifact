
<html>
<head>
<title>os/net/ipv6/uipbuf.h</title>
<link rel="stylesheet" type="text/css" href="../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * Copyright (c) 2017, RISE SICS, Yanzi Networks</div><div id="3" class="line none">    3  * All rights reserved.</div><div id="4" class="line none">    4  *</div><div id="5" class="line none">    5  * Redistribution and use in source and binary forms, with or without</div><div id="6" class="line none">    6  * modification, are permitted provided that the following conditions</div><div id="7" class="line none">    7  * are met:</div><div id="8" class="line none">    8  * 1. Redistributions of source code must retain the above copyright</div><div id="9" class="line none">    9  *    notice, this list of conditions and the following disclaimer.</div><div id="10" class="line none">   10  * 2. Redistributions in binary form must reproduce the above copyright</div><div id="11" class="line none">   11  *    notice, this list of conditions and the following disclaimer in the</div><div id="12" class="line none">   12  *    documentation and/or other materials provided with the distribution.</div><div id="13" class="line none">   13  * 3. The name of the authors may not be used to endorse or promote</div><div id="14" class="line none">   14  *    products derived from this software without specific prior</div><div id="15" class="line none">   15  *    written permission.</div><div id="16" class="line none">   16  *</div><div id="17" class="line none">   17  * THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS''</div><div id="18" class="line none">   18  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED</div><div id="19" class="line none">   19  * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A</div><div id="20" class="line none">   20  * PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE</div><div id="21" class="line none">   21  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</div><div id="22" class="line none">   22  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT</div><div id="23" class="line none">   23  * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR</div><div id="24" class="line none">   24  * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</div><div id="25" class="line none">   25  * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</div><div id="26" class="line none">   26  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE</div><div id="27" class="line none">   27  * USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH</div><div id="28" class="line none">   28  * DAMAGE.</div><div id="29" class="line none">   29  *</div><div id="30" class="line none">   30  *</div><div id="31" class="line none">   31  */</div><div id="32" class="line none">   32 </div><div id="33" class="line none">   33 #ifndef <a href="uipbuf.h.html#34">UIPBUF_H_</a></div><div id="34" class="line none">   34 #define <a href="uipbuf.h.html#34">UIPBUF_H_</a></div><div id="35" class="line none">   35 </div><div id="36" class="line none">   36 #include "contiki.h"</div><div id="37" class="line none">   37 struct <a href="uipbuf.h.html#37">uip_ip_hdr</a>;</div><div id="38" class="line none">   38 </div><div id="39" class="line none">   39 /**</div><div id="40" class="line none">   40  * \brief          Resets uIP buffer</div><div id="41" class="line none">   41  */</div><div id="42" class="line none">   42 void <a href="uipbuf.c.html#44">uipbuf_clear</a>(void);</div><div id="43" class="line none">   43 </div><div id="44" class="line none">   44 /**</div><div id="45" class="line none">   45  * \brief          Update uip buffer length for addition of an extension header</div><div id="46" class="line none">   46  * \param len      The length of the new extension header</div><div id="47" class="line none">   47  * \retval         true if the length fields were successfully set, false otherwise</div><div id="48" class="line none">   48  */</div><div id="49" class="line none">   49 bool <a href="uipbuf.c.html#53">uipbuf_add_ext_hdr</a>(int16_t <a href="uip-nd6.h.html#326">len</a>);</div><div id="50" class="line none">   50 </div><div id="51" class="line none">   51 /**</div><div id="52" class="line none">   52  * \brief          Set the length of the uIP buffer</div><div id="53" class="line none">   53  * \param len      The new length</div><div id="54" class="line none">   54  * \retval         true if the len was successfully set, false otherwise</div><div id="55" class="line none">   55  */</div><div id="56" class="line none">   56 bool <a href="uipbuf.c.html#65">uipbuf_set_len</a>(uint16_t <a href="uip-nd6.h.html#326">len</a>);</div><div id="57" class="line none">   57 </div><div id="58" class="line none">   58 /**</div><div id="59" class="line none">   59  * \brief          Updates the length field in the uIP buffer</div><div id="60" class="line none">   60  * \param hdr      The IPv6 header</div><div id="61" class="line none">   61  * \param len      The new length value</div><div id="62" class="line none">   62  */</div><div id="63" class="line none">   63 void <a href="uipbuf.c.html#76">uipbuf_set_len_field</a>(struct <a href="uipbuf.h.html#37">uip_ip_hdr</a> *hdr, uint16_t <a href="uip-nd6.h.html#326">len</a>);</div><div id="64" class="line none">   64 </div><div id="65" class="line none">   65 /**</div><div id="66" class="line none">   66  * \brief          Returns the value of the length field in the uIP buffer</div><div id="67" class="line none">   67  * \param hdr      The IPv6 header</div><div id="68" class="line none">   68  * \retval         The length value</div><div id="69" class="line none">   69  */</div><div id="70" class="line none">   70 uint16_t <a href="uipbuf.c.html#83">uipbuf_get_len_field</a>(struct <a href="uipbuf.h.html#37">uip_ip_hdr</a> *hdr);</div><div id="71" class="line none">   71 </div><div id="72" class="line none">   72 /**</div><div id="73" class="line none">   73  * \brief          Get the next IPv6 header.</div><div id="74" class="line none">   74  * \param buffer   A pointer to the buffer holding the IPv6 packet</div><div id="75" class="line none">   75  * \param size     The size of the data in the buffer</div><div id="76" class="line none">   76  * \param protocol A pointer to a variable where the protocol of the header will be stored</div><div id="77" class="line none">   77  * \param start    A flag that indicates if this is expected to be the IPv6 packet header or a later header (Extension header)</div><div id="78" class="line none">   78  * \retval         returns address of the next header, or NULL in case of insufficient buffer space</div><div id="79" class="line none">   79  *</div><div id="80" class="line none">   80  *                 This function moves to the next header in a IPv6 packet.</div><div id="81" class="line none">   81  */</div><div id="82" class="line none">   82 uint8_t *<a href="uipbuf.c.html#91">uipbuf_get_next_header</a>(uint8_t *buffer, uint16_t size, uint8_t *protocol, bool <a href="../../sys/stimer.h.html#84">start</a>);</div><div id="83" class="line none">   83 </div><div id="84" class="line none">   84 </div><div id="85" class="line none">   85 /**</div><div id="86" class="line none">   86  * \brief          Get the last IPv6 header.</div><div id="87" class="line none">   87  * \param buffer   A pointer to the buffer holding the IPv6 packet</div><div id="88" class="line none">   88  * \param size     The size of the data in the buffer</div><div id="89" class="line none">   89  * \param protocol A pointer to a variable where the protocol of the header will be stored</div><div id="90" class="line none">   90  * \retval         returns address of the last header, or NULL in case of insufficient buffer space</div><div id="91" class="line none">   91  *</div><div id="92" class="line none">   92  *                 This function moves to the last header of the IPv6 packet.</div><div id="93" class="line none">   93  */</div><div id="94" class="line none">   94 uint8_t *<a href="uipbuf.c.html#147">uipbuf_get_last_header</a>(uint8_t *buffer, uint16_t size, uint8_t *protocol);</div><div id="95" class="line none">   95 </div><div id="96" class="line none">   96 /**</div><div id="97" class="line none">   97  * \brief          Get an IPv6 header with a given protocol field.</div><div id="98" class="line none">   98  * \param buffer   A pointer to the buffer holding the IPv6 packet</div><div id="99" class="line none">   99  * \param size     The size of the data in the buffer</div><div id="100" class="line none">  100  * \param protocol The protocol we are looking for</div><div id="101" class="line none">  101  * \retval         returns address of the header if found, else NULL</div><div id="102" class="line none">  102  *</div><div id="103" class="line none">  103  *                 This function moves to the last header of the IPv6 packet.</div><div id="104" class="line none">  104  */</div><div id="105" class="line none">  105 uint8_t *<a href="uipbuf.c.html#162">uipbuf_search_header</a>(uint8_t *buffer, uint16_t size, uint8_t protocol);</div><div id="106" class="line none">  106 </div><div id="107" class="line none">  107 /**</div><div id="108" class="line none">  108  * \brief          Get the value of the attribute</div><div id="109" class="line none">  109  * \param type     The attribute to get the value of</div><div id="110" class="line none">  110  * \retval         the value of the attribute</div><div id="111" class="line none">  111  *</div><div id="112" class="line none">  112  *                 This function gets the value of a specific uipbuf attribute.</div><div id="113" class="line none">  113  */</div><div id="114" class="line none">  114 uint16_t <a href="uipbuf.c.html#186">uipbuf_get_attr</a>(uint8_t <a href="uip-ds6.h.html#209">type</a>);</div><div id="115" class="line none">  115 </div><div id="116" class="line none">  116 </div><div id="117" class="line none">  117 /**</div><div id="118" class="line none">  118  * \brief          Set the value of the attribute</div><div id="119" class="line none">  119  * \param type     The attribute to set the value of</div><div id="120" class="line none">  120  * \param value    The value to set</div><div id="121" class="line none">  121  * \retval         0 - indicates failure of setting the value</div><div id="122" class="line none">  122  * \retval         1 - indicates success of setting the value</div><div id="123" class="line none">  123  *</div><div id="124" class="line none">  124  *                 This function sets the value of a specific uipbuf attribute.</div><div id="125" class="line none">  125  */</div><div id="126" class="line none">  126 int <a href="uipbuf.c.html#195">uipbuf_set_attr</a>(uint8_t <a href="uip-ds6.h.html#209">type</a>, uint16_t value);</div><div id="127" class="line none">  127 </div><div id="128" class="line none">  128 /**</div><div id="129" class="line none">  129  * \brief          Set the default value of the attribute</div><div id="130" class="line none">  130  * \param type     The attribute to set the default value of</div><div id="131" class="line none">  131  * \param value    The value to set</div><div id="132" class="line none">  132  * \retval         0 - indicates failure of setting the value</div><div id="133" class="line none">  133  * \retval         1 - indicates success of setting the value</div><div id="134" class="line none">  134  *</div><div id="135" class="line none">  135  *                 This function sets the default value of a uipbuf attribute.</div><div id="136" class="line none">  136  */</div><div id="137" class="line none">  137 int <a href="uipbuf.c.html#205">uipbuf_set_default_attr</a>(uint8_t <a href="uip-ds6.h.html#209">type</a>, uint16_t value);</div><div id="138" class="line none">  138 </div><div id="139" class="line none">  139 /**</div><div id="140" class="line none">  140  * \brief          Set bits in the uipbuf attribute flags.</div><div id="141" class="line none">  141  * \param flag_bits The bits to set in the flag.</div><div id="142" class="line none">  142  *</div><div id="143" class="line none">  143  *                 This function sets the uipbuf attributes flag of specified bits.</div><div id="144" class="line none">  144  */</div><div id="145" class="line none">  145 void <a href="uipbuf.c.html#222">uipbuf_set_attr_flag</a>(uint16_t flag_bits);</div><div id="146" class="line none">  146 </div><div id="147" class="line none">  147 /**</div><div id="148" class="line none">  148  * \brief          Clear bits in the uipbuf attribute flags.</div><div id="149" class="line none">  149  * \param flag_bits The bits to clear in the flag.</div><div id="150" class="line none">  150  *</div><div id="151" class="line none">  151  *                 This function clears the uipbuf attributes flag of specified bits.</div><div id="152" class="line none">  152  */</div><div id="153" class="line none">  153 void <a href="uipbuf.c.html#229">uipbuf_clr_attr_flag</a>(uint16_t flag_bits);</div><div id="154" class="line none">  154 </div><div id="155" class="line none">  155 /**</div><div id="156" class="line none">  156  * \brief          Check if bits in the uipbuf attribute flag are set.</div><div id="157" class="line none">  157  * \param flag_bits The bits to check in the flag.</div><div id="158" class="line none">  158  *</div><div id="159" class="line none">  159  *                 This function checks if the specified bits are set in the</div><div id="160" class="line none">  160  *                 uipbuf attributes flag.</div><div id="161" class="line none">  161  */</div><div id="162" class="line none">  162 uint16_t <a href="uipbuf.c.html#235">uipbuf_is_attr_flag</a>(uint16_t flag_bits);</div><div id="163" class="line none">  163 </div><div id="164" class="line none">  164 </div><div id="165" class="line none">  165 /**</div><div id="166" class="line none">  166  * \brief          Clear all attributes.</div><div id="167" class="line none">  167  *</div><div id="168" class="line none">  168  *                 This function clear all attributes in the uipbuf attributes</div><div id="169" class="line none">  169  *                 including all flags.</div><div id="170" class="line none">  170  */</div><div id="171" class="line none">  171 void <a href="uipbuf.c.html#215">uipbuf_clear_attr</a>(void);</div><div id="172" class="line none">  172 </div><div id="173" class="line none">  173 /**</div><div id="174" class="line none">  174  * \brief          Initialize uipbuf attributes.</div><div id="175" class="line none">  175  *</div><div id="176" class="line none">  176  *                 This function initialize all attributes in the uipbuf</div><div id="177" class="line none">  177  *                 attributes including all flags.</div><div id="178" class="line none">  178  */</div><div id="179" class="line none">  179 void <a href="uipbuf.c.html#241">uipbuf_init</a>(void);</div><div id="180" class="line none">  180 </div><div id="181" class="line none">  181 /**</div><div id="182" class="line none">  182  * \brief The bits defined for uipbuf attributes flag.</div><div id="183" class="line none">  183  *</div><div id="184" class="line none">  184  */</div><div id="185" class="line none">  185 /* Avoid using NHC compression on the packet (6LoWPAN) */</div><div id="186" class="line none">  186 #define <a href="uipbuf.h.html#186">UIPBUF_ATTR_FLAGS_6LOWPAN_NO_NHC_COMPRESSION</a>      0x01</div><div id="187" class="line none">  187 /* Avoid using prefix compression on the packet (6LoWPAN) */</div><div id="188" class="line none">  188 #define <a href="uipbuf.h.html#188">UIPBUF_ATTR_FLAGS_6LOWPAN_NO_PREFIX_COMPRESSION</a>   0x02</div><div id="189" class="line none">  189 </div><div id="190" class="line none">  190 </div><div id="191" class="line none">  191 /* Use this initial security level if defined */</div><div id="192" class="line none">  192 #ifdef UIPBUF_ATTR_LLSEC_STARTUP_LEVEL</div><div id="193" class="line none">  193 #define <a href="uipbuf.h.html#193">UIPBUF_ATTR_LLSEC_LEVEL_MAC_DEFAULT</a> UIPBUF_ATTR_LLSEC_STARTUP_LEVEL</div><div id="194" class="line none">  194 #else</div><div id="195" class="line none">  195 /* Else MAC will set the default for this packet */</div><div id="196" class="line none">  196 #define <a href="uipbuf.h.html#193">UIPBUF_ATTR_LLSEC_LEVEL_MAC_DEFAULT</a>               0xffff</div><div id="197" class="line none">  197 #endif</div><div id="198" class="line none">  198 </div><div id="199" class="line none">  199 </div><div id="200" class="line none">  200 /**</div><div id="201" class="line none">  201  * \brief The attributes defined for uipbuf attributes function.</div><div id="202" class="line none">  202  *</div><div id="203" class="line none">  203  */</div><div id="204" class="line none">  204 enum {</div><div id="205" class="line none">  205   <a href="uipbuf.h.html#205">UIPBUF_ATTR_LLSEC_LEVEL</a>,      /**&lt; Control link layer security level. */</div><div id="206" class="line none">  206   <a href="uipbuf.h.html#206">UIPBUF_ATTR_LLSEC_KEY_ID</a>,     /**&lt; Control link layer security key ID. */</div><div id="207" class="line none">  207   <a href="uipbuf.h.html#207">UIPBUF_ATTR_INTERFACE_ID</a>,     /**&lt; The interface to output packet on */</div><div id="208" class="line none">  208   <a href="uipbuf.h.html#208">UIPBUF_ATTR_PHYSICAL_NETWORK_ID</a>, /**&lt; Physical network ID (mapped to PAN ID)*/</div><div id="209" class="line none">  209   <a href="uipbuf.h.html#209">UIPBUF_ATTR_MAX_MAC_TRANSMISSIONS</a>, /**&lt; MAX transmissions of the packet MAC */</div><div id="210" class="line none">  210   <a href="uipbuf.h.html#210">UIPBUF_ATTR_FLAGS</a>,   /**&lt; Flags that can control lower layers.  see above. */</div><div id="211" class="line none">  211   <a href="uipbuf.h.html#211">UIPBUF_ATTR_RSSI</a>, /**&lt; Last packet's RSSI */</div><div id="212" class="line none">  212   <a href="uipbuf.h.html#212">UIPBUF_ATTR_LINK_QUALITY</a>, /**&lt; Last packet's LQI */</div><div id="213" class="line none">  213   <a href="uipbuf.h.html#213">UIPBUF_ATTR_MAX</a></div><div id="214" class="line none">  214 };</div><div id="215" class="line none">  215 </div><div id="216" class="line none">  216 #endif /* UIPBUF_H_ */</div>
</div>
</body>
</html>
